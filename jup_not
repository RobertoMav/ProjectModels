{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 441,
   "id": "348cfc80",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import math\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "ec6c61fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression \n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import classification_report, confusion_matrix\n",
    "from sklearn.preprocessing import StandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "48a1c5c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "data = pd.read_csv('gender_submission.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 343,
   "id": "cfd51390",
   "metadata": {},
   "outputs": [],
   "source": [
    "test = pd.read_csv('test.csv')\n",
    "train = pd.read_csv('train.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "5d36ad00",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Name</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Ticket</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Braund, Mr. Owen Harris</td>\n",
       "      <td>male</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>A/5 21171</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>\n",
       "      <td>female</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>PC 17599</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>C85</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Heikkinen, Miss. Laina</td>\n",
       "      <td>female</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>STON/O2. 3101282</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>\n",
       "      <td>female</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>113803</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>C123</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Allen, Mr. William Henry</td>\n",
       "      <td>male</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>373450</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   PassengerId  Survived  Pclass  \\\n",
       "0            1         0       3   \n",
       "1            2         1       1   \n",
       "2            3         1       3   \n",
       "3            4         1       1   \n",
       "4            5         0       3   \n",
       "\n",
       "                                                Name     Sex   Age  SibSp  \\\n",
       "0                            Braund, Mr. Owen Harris    male  22.0      1   \n",
       "1  Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0      1   \n",
       "2                             Heikkinen, Miss. Laina  female  26.0      0   \n",
       "3       Futrelle, Mrs. Jacques Heath (Lily May Peel)  female  35.0      1   \n",
       "4                           Allen, Mr. William Henry    male  35.0      0   \n",
       "\n",
       "   Parch            Ticket     Fare Cabin Embarked  \n",
       "0      0         A/5 21171   7.2500   NaN        S  \n",
       "1      0          PC 17599  71.2833   C85        C  \n",
       "2      0  STON/O2. 3101282   7.9250   NaN        S  \n",
       "3      0            113803  53.1000  C123        S  \n",
       "4      0            373450   8.0500   NaN        S  "
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4c69e252",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>891.000000</td>\n",
       "      <td>891.000000</td>\n",
       "      <td>891.000000</td>\n",
       "      <td>714.000000</td>\n",
       "      <td>891.000000</td>\n",
       "      <td>891.000000</td>\n",
       "      <td>891.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>446.000000</td>\n",
       "      <td>0.383838</td>\n",
       "      <td>2.308642</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0.523008</td>\n",
       "      <td>0.381594</td>\n",
       "      <td>32.204208</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>257.353842</td>\n",
       "      <td>0.486592</td>\n",
       "      <td>0.836071</td>\n",
       "      <td>14.526497</td>\n",
       "      <td>1.102743</td>\n",
       "      <td>0.806057</td>\n",
       "      <td>49.693429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.420000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>223.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>20.125000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.910400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>446.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>14.454200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>668.500000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>31.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>891.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>80.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>512.329200</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       PassengerId    Survived      Pclass         Age       SibSp  \\\n",
       "count   891.000000  891.000000  891.000000  714.000000  891.000000   \n",
       "mean    446.000000    0.383838    2.308642   29.699118    0.523008   \n",
       "std     257.353842    0.486592    0.836071   14.526497    1.102743   \n",
       "min       1.000000    0.000000    1.000000    0.420000    0.000000   \n",
       "25%     223.500000    0.000000    2.000000   20.125000    0.000000   \n",
       "50%     446.000000    0.000000    3.000000   28.000000    0.000000   \n",
       "75%     668.500000    1.000000    3.000000   38.000000    1.000000   \n",
       "max     891.000000    1.000000    3.000000   80.000000    8.000000   \n",
       "\n",
       "            Parch        Fare  \n",
       "count  891.000000  891.000000  \n",
       "mean     0.381594   32.204208  \n",
       "std      0.806057   49.693429  \n",
       "min      0.000000    0.000000  \n",
       "25%      0.000000    7.910400  \n",
       "50%      0.000000   14.454200  \n",
       "75%      0.000000   31.000000  \n",
       "max      6.000000  512.329200  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "05e07f91",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Name</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Ticket</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Moran, Mr. James</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>330877</td>\n",
       "      <td>8.4583</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Williams, Mr. Charles Eugene</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>244373</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Masselmani, Mrs. Fatima</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2649</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Emir, Mr. Farred Chehab</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2631</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>29</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>O'Dwyer, Miss. Ellen \"Nellie\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>330959</td>\n",
       "      <td>7.8792</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>859</th>\n",
       "      <td>860</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Razi, Mr. Raihed</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2629</td>\n",
       "      <td>7.2292</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>863</th>\n",
       "      <td>864</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Sage, Miss. Dorothy Edith \"Dolly\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>CA. 2343</td>\n",
       "      <td>69.5500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>869</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>van Melkebeke, Mr. Philemon</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>345777</td>\n",
       "      <td>9.5000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>878</th>\n",
       "      <td>879</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Laleff, Mr. Kristo</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349217</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>888</th>\n",
       "      <td>889</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Johnston, Miss. Catherine Helen \"Carrie\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>W./C. 6607</td>\n",
       "      <td>23.4500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>177 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     PassengerId  Survived  Pclass                                      Name  \\\n",
       "5              6         0       3                          Moran, Mr. James   \n",
       "17            18         1       2              Williams, Mr. Charles Eugene   \n",
       "19            20         1       3                   Masselmani, Mrs. Fatima   \n",
       "26            27         0       3                   Emir, Mr. Farred Chehab   \n",
       "28            29         1       3             O'Dwyer, Miss. Ellen \"Nellie\"   \n",
       "..           ...       ...     ...                                       ...   \n",
       "859          860         0       3                          Razi, Mr. Raihed   \n",
       "863          864         0       3         Sage, Miss. Dorothy Edith \"Dolly\"   \n",
       "868          869         0       3               van Melkebeke, Mr. Philemon   \n",
       "878          879         0       3                        Laleff, Mr. Kristo   \n",
       "888          889         0       3  Johnston, Miss. Catherine Helen \"Carrie\"   \n",
       "\n",
       "        Sex  Age  SibSp  Parch      Ticket     Fare Cabin Embarked  \n",
       "5      male  NaN      0      0      330877   8.4583   NaN        Q  \n",
       "17     male  NaN      0      0      244373  13.0000   NaN        S  \n",
       "19   female  NaN      0      0        2649   7.2250   NaN        C  \n",
       "26     male  NaN      0      0        2631   7.2250   NaN        C  \n",
       "28   female  NaN      0      0      330959   7.8792   NaN        Q  \n",
       "..      ...  ...    ...    ...         ...      ...   ...      ...  \n",
       "859    male  NaN      0      0        2629   7.2292   NaN        C  \n",
       "863  female  NaN      8      2    CA. 2343  69.5500   NaN        S  \n",
       "868    male  NaN      0      0      345777   9.5000   NaN        S  \n",
       "878    male  NaN      0      0      349217   7.8958   NaN        S  \n",
       "888  female  NaN      1      2  W./C. 6607  23.4500   NaN        S  \n",
       "\n",
       "[177 rows x 12 columns]"
      ]
     },
     "execution_count": 135,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[train['Age'].isnull()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "96f02ba8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PassengerId      0\n",
       "Survived         0\n",
       "Pclass           0\n",
       "Name             0\n",
       "Sex              0\n",
       "Age            177\n",
       "SibSp            0\n",
       "Parch            0\n",
       "Ticket           0\n",
       "Fare             0\n",
       "Cabin          687\n",
       "Embarked         2\n",
       "dtype: int64"
      ]
     },
     "execution_count": 136,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "833fdaac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Name</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Ticket</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>62</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Icard, Miss. Amelie</td>\n",
       "      <td>female</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>113572</td>\n",
       "      <td>80.0</td>\n",
       "      <td>B28</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>829</th>\n",
       "      <td>830</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Stone, Mrs. George Nelson (Martha Evelyn)</td>\n",
       "      <td>female</td>\n",
       "      <td>62.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>113572</td>\n",
       "      <td>80.0</td>\n",
       "      <td>B28</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     PassengerId  Survived  Pclass  ...  Fare Cabin  Embarked\n",
       "61            62         1       1  ...  80.0   B28       NaN\n",
       "829          830         1       1  ...  80.0   B28       NaN\n",
       "\n",
       "[2 rows x 12 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[train['Embarked'].isnull()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 344,
   "id": "e35feb58",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Embarked', ylabel='count'>"
      ]
     },
     "execution_count": 344,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYgAAAEGCAYAAAB/+QKOAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAATuElEQVR4nO3df7DddX3n8edLfrRVodjlikCIYVzKbLQQ6W3U0nUBi0MyVCzLWjJtpdbZqCNu3enulK0z6v5w11mrTgtWNrsg0LGgrUbZNfJjaC1FsXLDRkhAJM3AkoaBoLuA9dcG3/vH+d7lcP3c5BDuOd+b3Odj5sz5fj/fz+d73smZe1/3+ztVhSRJcz2v7wIkSYuTASFJajIgJElNBoQkqcmAkCQ1Hdp3AQvp6KOPrhUrVvRdhiQdMDZv3vxYVU21lh1UAbFixQpmZmb6LkOSDhhJHpxvmbuYJElNBoQkqcmAkCQ1GRCSpCYDQpLUZEBIkprGFhBJTkjyl0nuTbItye907T+T5OYk93fvL5pn/DlJ7kuyPckl46pTktQ2zi2IPcDvVtU/Al4NvDPJSuAS4JaqOgm4pZt/hiSHAB8D1gArgXXdWEnShIwtIKrq4aq6s5t+ErgXOB44D7i663Y18MbG8NXA9qraUVU/BK7rxkmSJmQiV1InWQG8Evgb4JiqehgGIZLkxY0hxwMPDc3vBF41z7rXA+sBli9fPnJNP/+vrxm5r/bP5g+9eSzr/V//7ufGsl490/L33t13CerZ2A9SJ3kh8Bng3VX1xKjDGm3NR99V1Yaqmq6q6amp5u1EJEn7YawBkeQwBuHwyar6bNf8SJJju+XHAo82hu4EThiaXwbsGmetkqRnGudZTAGuAO6tqo8MLboeuKibvgj4fGP4HcBJSU5McjhwYTdOkjQh49yCOB34TeCsJFu611rgg8DZSe4Hzu7mSXJckk0AVbUHuBi4kcHB7U9X1bYx1ipJmmNsB6mr6jbaxxIAXtfovwtYOzS/Cdg0nuokSfvildSSpCYDQpLUZEBIkpoMCElSkwEhSWoyICRJTQaEJKnJgJAkNRkQkqQmA0KS1GRASJKaDAhJUpMBIUlqMiAkSU0GhCSpyYCQJDWN7YFBSa4EzgUerapXdG2fAk7uuhwF/J+qWtUY+wDwJPAUsKeqpsdVpySpbWwBAVwFXAZcM9tQVb82O53kw8Djexl/ZlU9NrbqJEl7Nc5Hjt6aZEVrWZIAbwLOGtfnS5Kem76OQfxj4JGqun+e5QXclGRzkvUTrEuS1BnnLqa9WQdcu5flp1fVriQvBm5O8o2qurXVsQuQ9QDLly9f+EolaYma+BZEkkOB84FPzdenqnZ1748CG4HVe+m7oaqmq2p6ampqocuVpCWrj11Mvwx8o6p2thYmeUGSI2angdcDWydYnySJMQZEkmuB24GTk+xM8tZu0YXM2b2U5Lgkm7rZY4Dbknwd+Brwhaq6YVx1SpLaxnkW07p52n+r0bYLWNtN7wBOHVddkqTReCW1JKnJgJAkNRkQkqQmA0KS1GRASJKaDAhJUpMBIUlqMiAkSU0GhCSpyYCQJDUZEJKkJgNCktRkQEiSmgwISVKTASFJajIgJElNBoQkqWmcjxy9MsmjSbYOtb0/yd8l2dK91s4z9pwk9yXZnuSScdUoSZrfOLcgrgLOabR/tKpWda9NcxcmOQT4GLAGWAmsS7JyjHVKkhrGFhBVdSvw7f0YuhrYXlU7quqHwHXAeQtanCRpn/o4BnFxkru6XVAvaiw/HnhoaH5n19aUZH2SmSQzu3fvXuhaJWnJmnRAfBx4GbAKeBj4cKNPGm013wqrakNVTVfV9NTU1IIUKUmacEBU1SNV9VRV/Qj4rwx2J821EzhhaH4ZsGsS9UmSnjbRgEhy7NDsrwJbG93uAE5KcmKSw4ELgesnUZ8k6WmHjmvFSa4FzgCOTrITeB9wRpJVDHYZPQC8ret7HPDfqmptVe1JcjFwI3AIcGVVbRtXnZKktrEFRFWtazRfMU/fXcDaoflNwI+dAitJmhyvpJYkNRkQkqQmA0KS1GRASJKaDAhJUpMBIUlqMiAkSU0GhCSpyYCQJDUZEJKkJgNCktRkQEiSmgwISVKTASFJajIgJElNBoQkqcmAkCQ1jS0gklyZ5NEkW4faPpTkG0nuSrIxyVHzjH0gyd1JtiSZGVeNkqT5jXML4irgnDltNwOvqKpTgG8C/2Yv48+sqlVVNT2m+iRJezG2gKiqW4Fvz2m7qar2dLNfBZaN6/MlSc9Nn8cgfhv44jzLCrgpyeYk6/e2kiTrk8wkmdm9e/eCFylJS1UvAZHkPcAe4JPzdDm9qk4D1gDvTPLa+dZVVRuqarqqpqempsZQrSQtTRMPiCQXAecCv15V1epTVbu690eBjcDqyVUoSYIJB0SSc4DfA95QVd+dp88LkhwxOw28Htja6itJGp9xnuZ6LXA7cHKSnUneClwGHAHc3J3CennX97gkm7qhxwC3Jfk68DXgC1V1w7jqlCS1HTquFVfVukbzFfP03QWs7aZ3AKeOqy5J0mi8klqS1GRASJKaDAhJUpMBIUlqGikgktwySpsk6eCx17OYkvwk8Hzg6CQvAtItOhI4bsy1SZJ6tK/TXN8GvJtBGGzm6YB4AvjY+MqSJPVtrwFRVX8I/GGSd1XVpROqSZK0CIx0oVxVXZrkF4EVw2Oq6pox1SVJ6tlIAZHkT4CXAVuAp7rmAgwISTpIjXqrjWlg5Xx3X5UkHXxGvQ5iK/CScRYiSVpcRt2COBq4J8nXgB/MNlbVG8ZSlSSpd6MGxPvHWYQkafEZ9Symvxp3IZKkxWXUs5ieZHDWEsDhwGHA31fVkeMqTJLUr1G3II4Ynk/yRnxOtCQd1Pbrbq5V9TngrL31SXJlkkeTbB1q+5kkNye5v3t/0Txjz0lyX5LtSS7ZnxolSc/NqHdzPX/odUGSD/L0Lqf5XAWcM6ftEuCWqjoJuKWbn/tZhzC4z9MaYCWwLsnKUeqUJC2cUc9i+pWh6T3AA8B5extQVbcmWTGn+TzgjG76auBLwO/N6bMa2N49m5ok13Xj7hmxVknSAhj1GMRbFujzjqmqh7t1PpzkxY0+xwMPDc3vBF413wqTrAfWAyxfvnyBypQkjbqLaVmSjd0xhUeSfCbJsjHVlEbbvLuzqmpDVU1X1fTU1NSYSpKkpWfUg9SfAK5n8FyI44H/3rU9W48kORage3+00WcncMLQ/DJg1358liTpORg1IKaq6hNVtad7XQXsz5/r1wMXddMXAZ9v9LkDOCnJiUkOBy7sxkmSJmjUgHgsyW8kOaR7/Qbwrb0NSHItcDtwcpKdSd4KfBA4O8n9wNndPEmOS7IJoKr2ABcDNwL3Ap+uqm3784+TJO2/Uc9i+m3gMuCjDI4HfAXY64Hrqlo3z6LXNfruAtYOzW8CNo1YmyRpDEYNiH8PXFRV/xsGF7wBf8AgOCRJB6FRdzGdMhsOAFX1beCV4ylJkrQYjBoQzxu+LUa3BTHq1ock6QA06i/5DwNfSfLnDI5BvAn4wNiqkiT1btQrqa9JMsPgBn0Bzq8qb30hSQexkXcTdYFgKEjSErFft/uWJB38DAhJUpMBIUlqMiAkSU0GhCSpyYCQJDUZEJKkJgNCktRkQEiSmgwISVKTASFJapp4QCQ5OcmWodcTSd49p88ZSR4f6vPeSdcpSUvdxJ/pUFX3AasAkhwC/B2wsdH1r6vq3AmWJkka0vcuptcBf1tVD/ZchyRpjr4D4kLg2nmWvSbJ15N8McnL51tBkvVJZpLM7N69ezxVStIS1FtAJDkceAPwZ43FdwIvrapTgUuBz823nqraUFXTVTU9NTU1llolaSnqcwtiDXBnVT0yd0FVPVFV3+mmNwGHJTl60gVK0lLWZ0CsY57dS0lekiTd9GoGdX5rgrVJ0pI38bOYAJI8HzgbeNtQ29sBqupy4ALgHUn2AN8DLqyq6qNWSVqqegmIqvou8A/mtF0+NH0ZcNmk65IkPa3vs5gkSYuUASFJajIgJElNBoQkqcmAkCQ1GRCSpCYDQpLUZEBIkpoMCElSkwEhSWoyICRJTQaEJKnJgJAkNRkQkqQmA0KS1GRASJKaDAhJUlMvAZHkgSR3J9mSZKaxPEn+KMn2JHclOa2POiVpKevlkaOdM6vqsXmWrQFO6l6vAj7evUuSJmSx7mI6D7imBr4KHJXk2L6LkqSlpK+AKOCmJJuTrG8sPx54aGh+Z9f2Y5KsTzKTZGb37t1jKFWSlqa+AuL0qjqNwa6kdyZ57ZzlaYyp1oqqakNVTVfV9NTU1ELXKUlLVi8BUVW7uvdHgY3A6jlddgInDM0vA3ZNpjpJEvQQEElekOSI2Wng9cDWOd2uB97cnc30auDxqnp4wqVK0pLWx1lMxwAbk8x+/p9W1Q1J3g5QVZcDm4C1wHbgu8BbeqhTkpa0iQdEVe0ATm20Xz40XcA7J1mXJOmZFutprpKknhkQkqQmA0KS1GRASJKaDAhJUpMBIUlqMiAkSU0GhCSpyYCQJDUZEJKkJgNCktRkQEiSmgwISVKTASFJajIgJElNBoQkqcmAkCQ19fFM6hOS/GWSe5NsS/I7jT5nJHk8yZbu9d5J1ylJS10fz6TeA/xuVd2Z5Ahgc5Kbq+qeOf3+uqrO7aE+SRI9bEFU1cNVdWc3/SRwL3D8pOuQJO1dr8cgkqwAXgn8TWPxa5J8PckXk7x8L+tYn2Qmyczu3bvHVaokLTm9BUSSFwKfAd5dVU/MWXwn8NKqOhW4FPjcfOupqg1VNV1V01NTU2OrV5KWml4CIslhDMLhk1X12bnLq+qJqvpON70JOCzJ0RMuU5KWtD7OYgpwBXBvVX1knj4v6fqRZDWDOr81uSolSX2cxXQ68JvA3Um2dG2/DywHqKrLgQuAdyTZA3wPuLCqqodaJWnJmnhAVNVtQPbR5zLgsslUJGmSTr/09L5LOOh9+V1fXpD1eCW1JKnJgJAkNRkQkqQmA0KS1GRASJKaDAhJUpMBIUlqMiAkSU0GhCSpyYCQJDUZEJKkJgNCktRkQEiSmgwISVKTASFJajIgJElNBoQkqamXgEhyTpL7kmxPckljeZL8Ubf8riSn9VGnJC1lEw+IJIcAHwPWACuBdUlWzum2Bjipe60HPj7RIiVJvWxBrAa2V9WOqvohcB1w3pw+5wHX1MBXgaOSHDvpQiVpKTu0h888HnhoaH4n8KoR+hwPPDx3ZUnWM9jKAPhOkvsWrtRF5Wjgsb6LeDbyBxf1XcJicsB9f7wvfVewmBxQ31/+xbP67l4634I+AqJVee1Hn0Fj1QZgw3MtarFLMlNV033Xof3j93dgW6rfXx+7mHYCJwzNLwN27UcfSdIY9REQdwAnJTkxyeHAhcD1c/pcD7y5O5vp1cDjVfVju5ckSeMz8V1MVbUnycXAjcAhwJVVtS3J27vllwObgLXAduC7wFsmXecidNDvRjvI+f0d2Jbk95eq5q59SdIS55XUkqQmA0KS1GRALHJJXpLkuiR/m+SeJJuS/GzfdWk0Sd6TZFt3y5gtSeZe86NFKsmyJJ9Pcn+SHUkuS/ITfdc1SQbEIpYkwEbgS1X1sqpaCfw+cEy/lWkUSV4DnAucVlWnAL/MMy8A1SLV/ex9FvhcVc3e9uengP/ca2ET1seFchrdmcD/7c7sAqCqtvRXjp6lY4HHquoHAFV1wFyJK84Cvl9VnwCoqqeS/EvgwSTvqarv9FveZLgFsbi9AtjcdxHabzcBJyT5ZpI/TvJP+i5II3s5c372quoJ4AHgH/ZRUB8MCGlMur8yf57BvcJ2A59K8lu9FqVRhfbtfZbUDaoMiMVtG4NfMDpAVdVTVfWlqnofcDHwT/uuSSPZBjzj3ktJjmRw/O9gvSHojzEgFre/AH4iyT+fbUjyC+6qODAkOTnJSUNNq4AHeypHz84twPOTvBn+/3NsPgxcVlXf67WyCTIgFrEaXOb+q8DZ3Wmu24D3440LDxQvBK7uTk++i8EDst7fb0kaxdDP3gVJ7ge+Bfyoqj7Qb2WT5a02JGkfkvwicC1wflUtmRNHDAhJUpO7mCRJTQaEJKnJgJAkNRkQkqQmA0ICkjzV3W119nXJsxh7RpL/8Rw//0tJpvfdszn2qiQXPJfPl1q8WZ808L2qWtXHB3cXYUmLjlsQ0l4keSDJf0xye5KZJKclubG7cPHtQ12PTLKxuyju8iTP68Z/vBu3Lcm/nbPe9ya5DfhnQ+3PS3J1kv+Q5JAkH0pyR/c8ibd1fdI9m+CeJF8AXjyh/w4tMW5BSAM/lWTL0Px/qqpPddMPVdVrknwUuAo4HfhJBvfrmb0V+2oGV0o/CNwAnA/8OfCeqvp2t5VwS5JTququbsz3q+qXALqwORT4JLC1qj6QZD3weFX9Qvegmi8nuQl4JXAy8HMM7g10D3DlAv9/SAaE1NnbLqbru/e7gRdW1ZPAk0m+n+SobtnXqmoHQJJrgV9iEBBv6n7RH8rg+RArgdmAmA2gWf8F+PTQ7RxeD5wydHzhpxk8uOa1wLVV9RSwK8lf7M8/WNoXdzFJ+/aD7v1HQ9Oz87N/ZM29JUElORH4V8DruifKfYHBlsesv58z5ivAmUlm+wR4V1Wt6l4nVtVN83yetOAMCGlhrE5yYnfs4deA24AjGYTA40mOAdbsYx1XAJuAP0tyKHAj8I4khwEk+dkkLwBuBS7sjlEcy+DJg9KCcxeTNDD3GMQNVTXyqa7A7cAHGRwXuBXYWFU/SvI/GRyr2AF8eV8rqaqPJPlp4E+AXwdWAHd2z0jeDbyRwXPKz2Kwy+ubwF89izqlkXmzPklSk7uYJElNBoQkqcmAkCQ1GRCSpCYDQpLUZEBIkpoMCElS0/8D/cZKWgAI+LUAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "check = train[(train['Fare']>=75) & (train['Fare']<=95)].sort_values(by=['Fare'])\n",
    "sns.countplot(data=check, x='Embarked')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 345,
   "id": "0c4cbf10",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_val = train.drop(columns=['Ticket','PassengerId','Name'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 346,
   "id": "add49772",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>male</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>female</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>C85</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>female</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>female</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>C123</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>male</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass     Sex   Age  SibSp  Parch     Fare Cabin Embarked\n",
       "0         0       3    male  22.0      1      0   7.2500   NaN        S\n",
       "1         1       1  female  38.0      1      0  71.2833   C85        C\n",
       "2         1       3  female  26.0      0      0   7.9250   NaN        S\n",
       "3         1       1  female  35.0      1      0  53.1000  C123        S\n",
       "4         0       3    male  35.0      0      0   8.0500   NaN        S"
      ]
     },
     "execution_count": 346,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_val.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 347,
   "id": "ff92aaab",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_val['Sex'] = train_val['Sex'].apply(lambda x: 1 if x == 'male' else 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 348,
   "id": "d3bb8174",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    577\n",
       "0    314\n",
       "Name: Sex, dtype: int64"
      ]
     },
     "execution_count": 348,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_val['Sex'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 349,
   "id": "d963feb9",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_check = pd.get_dummies(train_val['Embarked'],drop_first=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 350,
   "id": "c4a4b4f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df = pd.concat([train_val, train_check],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 351,
   "id": "0bded385",
   "metadata": {},
   "outputs": [],
   "source": [
    "change_shit = final_df[final_df['Age'].notnull()]\n",
    "change_shit = change_shit[['Age','Pclass']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 352,
   "id": "20225f4b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Pclass</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>38.233441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>29.877630</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>25.140620</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Age\n",
       "Pclass           \n",
       "1       38.233441\n",
       "2       29.877630\n",
       "3       25.140620"
      ]
     },
     "execution_count": 352,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "change_shit = change_shit.groupby(['Pclass']).mean()\n",
    "change_shit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 353,
   "id": "a98875cf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "38.233440860215055"
      ]
     },
     "execution_count": 353,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np_age = change_shit.to_numpy()\n",
    "np_age[0][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 354,
   "id": "fd4dfd31",
   "metadata": {},
   "outputs": [],
   "source": [
    "def change_age(cols):\n",
    "    Age = cols[0]\n",
    "    Pclass = cols[1]\n",
    "    \n",
    "    if pd.isnull(Age):\n",
    "\n",
    "        if Pclass == 1:\n",
    "            return np_age[0][0]\n",
    "\n",
    "        elif Pclass == 2:\n",
    "            return np_age[1][0]\n",
    "\n",
    "        else:\n",
    "            return np_age[2][0]\n",
    "\n",
    "    else:\n",
    "        return Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 355,
   "id": "a0fd3669",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>C85</td>\n",
       "      <td>C</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>C123</td>\n",
       "      <td>S</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare Cabin Embarked  Q  S\n",
       "0         0       3    1  22.0      1      0   7.2500   NaN        S  0  1\n",
       "1         1       1    0  38.0      1      0  71.2833   C85        C  0  0\n",
       "2         1       3    0  26.0      0      0   7.9250   NaN        S  0  1\n",
       "3         1       1    0  35.0      1      0  53.1000  C123        S  0  1\n",
       "4         0       3    1  35.0      0      0   8.0500   NaN        S  0  1"
      ]
     },
     "execution_count": 355,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df['Age'] = final_df[['Age','Pclass']].apply(change_age,axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 356,
   "id": "8369289f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Survived      0\n",
       "Pclass        0\n",
       "Sex           0\n",
       "Age           0\n",
       "SibSp         0\n",
       "Parch         0\n",
       "Fare          0\n",
       "Cabin       687\n",
       "Embarked      2\n",
       "Q             0\n",
       "S             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 356,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 358,
   "id": "d8bb6185",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare  Q  S\n",
       "0         0       3    1  22.0      1      0   7.2500  0  1\n",
       "1         1       1    0  38.0      1      0  71.2833  0  0\n",
       "2         1       3    0  26.0      0      0   7.9250  0  1\n",
       "3         1       1    0  35.0      1      0  53.1000  0  1\n",
       "4         0       3    1  35.0      0      0   8.0500  0  1"
      ]
     },
     "execution_count": 358,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df = final_df.drop(['Embarked'],axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "id": "024344b1",
   "metadata": {},
   "outputs": [],
   "source": [
    "#final_df = pd.read_csv('final_df.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 359,
   "id": "d18327cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df['AgeFare'] = final_df['Age'] * final_df['Fare']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 360,
   "id": "ef658213",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='AgeFare', ylabel='Survived'>"
      ]
     },
     "execution_count": 360,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_viz = final_df[['AgeFare','Survived']]\n",
    "df_viz.plot(x='AgeFare', y='Survived', kind='scatter')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 361,
   "id": "071edba7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AgeFare</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Survived</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>384561.672427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>526596.165717</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                AgeFare\n",
       "Survived               \n",
       "0         384561.672427\n",
       "1         526596.165717"
      ]
     },
     "execution_count": 361,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df[['AgeFare','Survived']].groupby('Survived').sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 362,
   "id": "de85be8a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>AgeFare</th>\n",
       "      <th>Parch_1</th>\n",
       "      <th>Parch_2</th>\n",
       "      <th>Parch_3</th>\n",
       "      <th>Parch_4</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>159.5000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2708.7654</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>206.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1858.5000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>281.7500</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare  Q  S    AgeFare  \\\n",
       "0         0       3    1  22.0      1      0   7.2500  0  1   159.5000   \n",
       "1         1       1    0  38.0      1      0  71.2833  0  0  2708.7654   \n",
       "2         1       3    0  26.0      0      0   7.9250  0  1   206.0500   \n",
       "3         1       1    0  35.0      1      0  53.1000  0  1  1858.5000   \n",
       "4         0       3    1  35.0      0      0   8.0500  0  1   281.7500   \n",
       "\n",
       "   Parch_1  Parch_2  Parch_3  Parch_4  Parch_5  Parch_6  \n",
       "0        0        0        0        0        0        0  \n",
       "1        0        0        0        0        0        0  \n",
       "2        0        0        0        0        0        0  \n",
       "3        0        0        0        0        0        0  \n",
       "4        0        0        0        0        0        0  "
      ]
     },
     "execution_count": 362,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_check = pd.get_dummies(final_df['Parch'],drop_first=True,prefix='Parch')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 363,
   "id": "7e69a114",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>AgeFare</th>\n",
       "      <th>...</th>\n",
       "      <th>Parch_3</th>\n",
       "      <th>Parch_4</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "      <th>SibSp_1</th>\n",
       "      <th>SibSp_2</th>\n",
       "      <th>SibSp_3</th>\n",
       "      <th>SibSp_4</th>\n",
       "      <th>SibSp_5</th>\n",
       "      <th>SibSp_8</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>159.5000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2708.7654</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>206.0500</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1858.5000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>281.7500</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare  Q  S    AgeFare  ...  \\\n",
       "0         0       3    1  22.0      1      0   7.2500  0  1   159.5000  ...   \n",
       "1         1       1    0  38.0      1      0  71.2833  0  0  2708.7654  ...   \n",
       "2         1       3    0  26.0      0      0   7.9250  0  1   206.0500  ...   \n",
       "3         1       1    0  35.0      1      0  53.1000  0  1  1858.5000  ...   \n",
       "4         0       3    1  35.0      0      0   8.0500  0  1   281.7500  ...   \n",
       "\n",
       "   Parch_3  Parch_4  Parch_5  Parch_6  SibSp_1  SibSp_2  SibSp_3  SibSp_4  \\\n",
       "0        0        0        0        0        1        0        0        0   \n",
       "1        0        0        0        0        1        0        0        0   \n",
       "2        0        0        0        0        0        0        0        0   \n",
       "3        0        0        0        0        1        0        0        0   \n",
       "4        0        0        0        0        0        0        0        0   \n",
       "\n",
       "   SibSp_5  SibSp_8  \n",
       "0        0        0  \n",
       "1        0        0  \n",
       "2        0        0  \n",
       "3        0        0  \n",
       "4        0        0  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 363,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_check = pd.get_dummies(final_df['SibSp'],drop_first=True,prefix='SibSp')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 364,
   "id": "0998182f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>AgeFare</th>\n",
       "      <th>...</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "      <th>SibSp_1</th>\n",
       "      <th>SibSp_2</th>\n",
       "      <th>SibSp_3</th>\n",
       "      <th>SibSp_4</th>\n",
       "      <th>SibSp_5</th>\n",
       "      <th>SibSp_8</th>\n",
       "      <th>Pclass_2</th>\n",
       "      <th>Pclass_3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>159.5000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2708.7654</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>206.0500</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1858.5000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>281.7500</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Pclass  Sex   Age  SibSp  Parch     Fare  Q  S    AgeFare  ...  \\\n",
       "0         0       3    1  22.0      1      0   7.2500  0  1   159.5000  ...   \n",
       "1         1       1    0  38.0      1      0  71.2833  0  0  2708.7654  ...   \n",
       "2         1       3    0  26.0      0      0   7.9250  0  1   206.0500  ...   \n",
       "3         1       1    0  35.0      1      0  53.1000  0  1  1858.5000  ...   \n",
       "4         0       3    1  35.0      0      0   8.0500  0  1   281.7500  ...   \n",
       "\n",
       "   Parch_5  Parch_6  SibSp_1  SibSp_2  SibSp_3  SibSp_4  SibSp_5  SibSp_8  \\\n",
       "0        0        0        1        0        0        0        0        0   \n",
       "1        0        0        1        0        0        0        0        0   \n",
       "2        0        0        0        0        0        0        0        0   \n",
       "3        0        0        1        0        0        0        0        0   \n",
       "4        0        0        0        0        0        0        0        0   \n",
       "\n",
       "   Pclass_2  Pclass_3  \n",
       "0         0         1  \n",
       "1         0         0  \n",
       "2         0         1  \n",
       "3         0         0  \n",
       "4         0         1  \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 364,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_check = pd.get_dummies(final_df['Pclass'],drop_first=True,prefix='Pclass')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 365,
   "id": "6775bccd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>AgeFare</th>\n",
       "      <th>Parch_1</th>\n",
       "      <th>Parch_2</th>\n",
       "      <th>Parch_3</th>\n",
       "      <th>...</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "      <th>SibSp_1</th>\n",
       "      <th>SibSp_2</th>\n",
       "      <th>SibSp_3</th>\n",
       "      <th>SibSp_4</th>\n",
       "      <th>SibSp_5</th>\n",
       "      <th>SibSp_8</th>\n",
       "      <th>Pclass_2</th>\n",
       "      <th>Pclass_3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>159.5000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2708.7654</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>206.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1858.5000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>281.7500</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Sex   Age     Fare  Q  S    AgeFare  Parch_1  Parch_2  Parch_3  \\\n",
       "0         0    1  22.0   7.2500  0  1   159.5000        0        0        0   \n",
       "1         1    0  38.0  71.2833  0  0  2708.7654        0        0        0   \n",
       "2         1    0  26.0   7.9250  0  1   206.0500        0        0        0   \n",
       "3         1    0  35.0  53.1000  0  1  1858.5000        0        0        0   \n",
       "4         0    1  35.0   8.0500  0  1   281.7500        0        0        0   \n",
       "\n",
       "   ...  Parch_5  Parch_6  SibSp_1  SibSp_2  SibSp_3  SibSp_4  SibSp_5  \\\n",
       "0  ...        0        0        1        0        0        0        0   \n",
       "1  ...        0        0        1        0        0        0        0   \n",
       "2  ...        0        0        0        0        0        0        0   \n",
       "3  ...        0        0        1        0        0        0        0   \n",
       "4  ...        0        0        0        0        0        0        0   \n",
       "\n",
       "   SibSp_8  Pclass_2  Pclass_3  \n",
       "0        0         0         1  \n",
       "1        0         0         0  \n",
       "2        0         0         1  \n",
       "3        0         0         0  \n",
       "4        0         0         1  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 365,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df = final_df.drop([('SibSp')],axis=1)\n",
    "final_df = final_df.drop([('Parch')],axis=1)\n",
    "final_df = final_df.drop([('Pclass')],axis=1)\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 366,
   "id": "866bee7c",
   "metadata": {},
   "outputs": [],
   "source": [
    "in_3 = np.arange(start=0, stop=100, step=3)\n",
    "def age_class(age):\n",
    "    #get age index in 3 by 3 array\n",
    "    ind = int(age // 3)\n",
    "    return in_3[ind]\n",
    "\n",
    "final_df['Age_cluster'] = final_df['Age'].apply(age_class)\n",
    "df_check = pd.get_dummies(final_df['Age_cluster'],drop_first=True,prefix='Age')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df = final_df.drop(['Age'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 367,
   "id": "74138fd4",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "in_25 = np.arange(start=final_df['Fare'].min(), stop=final_df['Fare'].max(), step=25)\n",
    "def fare_class(fare):\n",
    "    #get fare index in 25 ++ array\n",
    "    ind = int(fare // 25)\n",
    "    return in_25[ind]\n",
    "\n",
    "final_df['Fare_cluster'] = final_df['Fare'].apply(fare_class)\n",
    "df_check = pd.get_dummies(final_df['Fare_cluster'],drop_first=True,prefix='Fare')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df = final_df.drop(['Fare'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 368,
   "id": "954978ac",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "in_1 = np.arange(start=0, stop=2500, step=150)\n",
    "in_2 = np.arange(start=2500, stop=7500, step=500)\n",
    "in_3 = np.arange(start=7500, stop=final_df['AgeFare'].max(), step=2500)\n",
    "in_agefare = np.concatenate((in_1,in_2,in_3),axis=None)\n",
    "def agefare_class(Agefare):\n",
    "    #get fare index in 25 ++ array\n",
    "    if Agefare <= 2500: \n",
    "        ind = int(Agefare // 150)\n",
    "    elif Agefare <= 7500:\n",
    "        ind = int(Agefare // 500)\n",
    "    else:\n",
    "        ind = int(Agefare // 2500)\n",
    "    return in_agefare[ind]\n",
    "\n",
    "final_df['AgeFare_cluster'] = final_df['AgeFare'].apply(agefare_class)\n",
    "df_check = pd.get_dummies(final_df['AgeFare_cluster'],drop_first=True,prefix='Age_Fare')\n",
    "final_df = pd.concat([final_df, df_check],axis=1)\n",
    "final_df = final_df.drop(['AgeFare'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 404,
   "id": "761e826f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>Parch_1</th>\n",
       "      <th>Parch_2</th>\n",
       "      <th>Parch_3</th>\n",
       "      <th>Parch_4</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "      <th>...</th>\n",
       "      <th>Age_Fare_1050.0</th>\n",
       "      <th>Age_Fare_1200.0</th>\n",
       "      <th>Age_Fare_1350.0</th>\n",
       "      <th>Age_Fare_1500.0</th>\n",
       "      <th>Age_Fare_1650.0</th>\n",
       "      <th>Age_Fare_1800.0</th>\n",
       "      <th>Age_Fare_1950.0</th>\n",
       "      <th>Age_Fare_2100.0</th>\n",
       "      <th>Age_Fare_2250.0</th>\n",
       "      <th>Age_Fare_2400.0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 69 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Survived  Sex  Q  S  Parch_1  Parch_2  Parch_3  Parch_4  Parch_5  Parch_6  \\\n",
       "0         0    1  0  1        0        0        0        0        0        0   \n",
       "1         1    0  0  0        0        0        0        0        0        0   \n",
       "2         1    0  0  1        0        0        0        0        0        0   \n",
       "3         1    0  0  1        0        0        0        0        0        0   \n",
       "4         0    1  0  1        0        0        0        0        0        0   \n",
       "\n",
       "   ...  Age_Fare_1050.0  Age_Fare_1200.0  Age_Fare_1350.0  Age_Fare_1500.0  \\\n",
       "0  ...                0                0                0                0   \n",
       "1  ...                0                0                0                0   \n",
       "2  ...                0                0                0                0   \n",
       "3  ...                0                0                0                0   \n",
       "4  ...                0                0                0                0   \n",
       "\n",
       "   Age_Fare_1650.0  Age_Fare_1800.0  Age_Fare_1950.0  Age_Fare_2100.0  \\\n",
       "0                0                0                0                0   \n",
       "1                0                0                0                0   \n",
       "2                0                0                0                0   \n",
       "3                0                1                0                0   \n",
       "4                0                0                0                0   \n",
       "\n",
       "   Age_Fare_2250.0  Age_Fare_2400.0  \n",
       "0                0                0  \n",
       "1                0                0  \n",
       "2                0                0  \n",
       "3                0                0  \n",
       "4                0                0  \n",
       "\n",
       "[5 rows x 69 columns]"
      ]
     },
     "execution_count": 404,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# final_df['AgeFare'].plot(x='AgeFare',kind='hist')\n",
    "# print(final_df['AgeFare'].min())\n",
    "# print(final_df['AgeFare'].max())\n",
    "final_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 372,
   "id": "d3e6a2db",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Survived', 'Sex', 'Q', 'S', 'Parch_1', 'Parch_2', 'Parch_3', 'Parch_4',\n",
       "       'Parch_5', 'Parch_6', 'SibSp_1', 'SibSp_2', 'SibSp_3', 'SibSp_4',\n",
       "       'SibSp_5', 'SibSp_8', 'Pclass_2', 'Pclass_3', 'Age_3', 'Age_6', 'Age_9',\n",
       "       'Age_12', 'Age_15', 'Age_18', 'Age_21', 'Age_24', 'Age_27', 'Age_30',\n",
       "       'Age_33', 'Age_36', 'Age_39', 'Age_42', 'Age_45', 'Age_48', 'Age_51',\n",
       "       'Age_54', 'Age_57', 'Age_60', 'Age_63', 'Age_66', 'Age_69', 'Age_72',\n",
       "       'Age_78', 'Fare_25.0', 'Fare_50.0', 'Fare_75.0', 'Fare_100.0',\n",
       "       'Fare_125.0', 'Fare_150.0', 'Fare_200.0', 'Fare_225.0', 'Fare_250.0',\n",
       "       'Fare_500.0', 'Age_Fare_150.0', 'Age_Fare_300.0', 'Age_Fare_450.0',\n",
       "       'Age_Fare_600.0', 'Age_Fare_750.0', 'Age_Fare_900.0', 'Age_Fare_1050.0',\n",
       "       'Age_Fare_1200.0', 'Age_Fare_1350.0', 'Age_Fare_1500.0',\n",
       "       'Age_Fare_1650.0', 'Age_Fare_1800.0', 'Age_Fare_1950.0',\n",
       "       'Age_Fare_2100.0', 'Age_Fare_2250.0', 'Age_Fare_2400.0'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 372,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df = final_df.drop(['Age_cluster'],axis=1)\n",
    "final_df.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b219450f",
   "metadata": {},
   "source": [
    "## Testing importing TF(Keras) logistic regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 373,
   "id": "c48d28ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df.to_csv('final_df_binary.csv',index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 374,
   "id": "1ec5c8e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "y = final_df['Survived']\n",
    "x = final_df.drop(['Survived'], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 375,
   "id": "e42fc025",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=101)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "2ca0a9dd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LogisticRegression()"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model_sk_log = LogisticRegression()\n",
    "model_sk_log.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "648f3f12",
   "metadata": {},
   "outputs": [],
   "source": [
    "pred_test = model_sk_log.predict(X_test)\n",
    "pred_train = model_sk_log.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "b016ee50",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.79      0.92      0.85        99\n",
      "           1       0.88      0.70      0.78        80\n",
      "\n",
      "    accuracy                           0.82       179\n",
      "   macro avg       0.83      0.81      0.81       179\n",
      "weighted avg       0.83      0.82      0.82       179\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test,pred_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "id": "6566e29b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[91  8]\n",
      " [24 56]]\n"
     ]
    }
   ],
   "source": [
    "print(confusion_matrix(y_test,pred_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "f9e98443",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 82.122905\n"
     ]
    }
   ],
   "source": [
    "print('Train Accuracy: %f'%(np.mean(pred == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "id": "9997aa0f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.179\n",
      "error train: 0.190\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, pred_test)\n",
    "error_train = eval_err(y_train, pred_train)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "618af669",
   "metadata": {},
   "source": [
    "## Testing building Log Reg model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 393,
   "id": "af203c9d",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train = X_train.to_numpy()\n",
    "y_train = y_train.to_numpy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "efd565bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "scaler = StandardScaler()\n",
    "X_train = scaler.fit_transform(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "b0a31e47",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_test = scaler.fit_transform(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "417474d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Create sigmoid function\n",
    "## Compute loss function, sum to get cost (add regularization)\n",
    "## Add gradient descent calculation \n",
    "## Updating the weights\n",
    "## Check pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "52f4dcdd",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sigmoid(z):\n",
    "\n",
    "    calc = math.e**-z\n",
    "    g = 1 / (1 + calc)\n",
    "\n",
    "    return g"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "23d7778a",
   "metadata": {},
   "source": [
    "<a name=\"2.4\"></a>\n",
    "### 2.4 Cost function for logistic regression\n",
    "\n",
    "In this section, you will implement the cost function for logistic regression.\n",
    "\n",
    "<a name='ex-02'></a>\n",
    "### Exercise 2\n",
    "\n",
    "Please complete the `compute_cost` function using the equations below.\n",
    "\n",
    "Recall that for logistic regression, the cost function is of the form \n",
    "\n",
    "$$ J(\\mathbf{w},b) = \\frac{1}{m}\\sum_{i=0}^{m-1} \\left[ loss(f_{\\mathbf{w},b}(\\mathbf{x}^{(i)}), y^{(i)}) \\right] \\tag{1}$$\n",
    "\n",
    "where\n",
    "* m is the number of training examples in the dataset\n",
    "\n",
    "\n",
    "* $loss(f_{\\mathbf{w},b}(\\mathbf{x}^{(i)}), y^{(i)})$ is the cost for a single data point, which is - \n",
    "\n",
    "    $$loss(f_{\\mathbf{w},b}(\\mathbf{x}^{(i)}), y^{(i)}) = (-y^{(i)} \\log\\left(f_{\\mathbf{w},b}\\left( \\mathbf{x}^{(i)} \\right) \\right) - \\left( 1 - y^{(i)}\\right) \\log \\left( 1 - f_{\\mathbf{w},b}\\left( \\mathbf{x}^{(i)} \\right) \\right) \\tag{2}$$\n",
    "    \n",
    "    \n",
    "*  $f_{\\mathbf{w},b}(\\mathbf{x}^{(i)})$ is the model's prediction, while $y^{(i)}$, which is the actual label\n",
    "\n",
    "*  $f_{\\mathbf{w},b}(\\mathbf{x}^{(i)}) = g(\\mathbf{w} \\cdot \\mathbf{x^{(i)}} + b)$ where function $g$ is the sigmoid function.\n",
    "    * It might be helpful to first calculate an intermediate variable $z_{\\mathbf{w},b}(\\mathbf{x}^{(i)}) = \\mathbf{w} \\cdot \\mathbf{x^{(i)}} + b = w_0x^{(i)}_0 + ... + w_{n-1}x^{(i)}_{n-1} + b$ where $n$ is the number of features, before calculating $f_{\\mathbf{w},b}(\\mathbf{x}^{(i)}) = g(z_{\\mathbf{w},b}(\\mathbf{x}^{(i)}))$\n",
    "\n",
    "Note:\n",
    "* As you are doing this, remember that the variables `X_train` and `y_train` are not scalar values but matrices of shape ($m, n$) and ($𝑚$,1) respectively, where  $𝑛$ is the number of features and $𝑚$ is the number of training examples.\n",
    "* You can use the sigmoid function that you implemented above for this part."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "036bcd36",
   "metadata": {},
   "outputs": [],
   "source": [
    "def loss_calc(X, y, w, b, lambda_):\n",
    "    train_ex, featur = X.shape\n",
    "    total_cost = 0 \n",
    "    \n",
    "    for i in range(train_ex):\n",
    "        \n",
    "        sig_i = sigmoid(np.dot(X[i],w) + b)\n",
    "        check = (- y[i] * np.log(sig_i)) - ((1 - y[i]) * np.log(1 - sig_i))\n",
    "        total_cost += check\n",
    "    \n",
    "    total_cost = total_cost / train_ex\n",
    "    \n",
    "    reg = 0\n",
    "    for j in range(featur):\n",
    "        reg += w[j]**2\n",
    "    \n",
    "    reg = lambda_/(2*featur) * reg\n",
    "    \n",
    "    final_cost = total_cost + reg\n",
    "    \n",
    "    return final_cost"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "419145b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def gradient_descent(X, y, w, b, lambda_):\n",
    "    train_ex, featur = X.shape\n",
    "    \n",
    "    dj_dw = np.zeros(w.shape)\n",
    "    dj_db = 0.\n",
    "        \n",
    "    for i in range(train_ex):\n",
    "        pred = sigmoid(np.dot(X[i], w) + b)\n",
    "        dj_db += pred - y[i]\n",
    "        \n",
    "        for j in range(featur):\n",
    "            dj_dw[j] += (pred - y[i]) * X[i][j]\n",
    "    \n",
    "    dj_db = dj_db / featur\n",
    "    dj_dw = dj_dw / featur\n",
    "    \n",
    "    for i in range(featur):\n",
    "        reg = lambda_ / featur * w[j]\n",
    "        dj_dw[j] += reg\n",
    "    \n",
    "    return dj_dw, dj_db"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "f4d65c38",
   "metadata": {},
   "outputs": [],
   "source": [
    "def compute_gradient(X, y, w_in, b_in, cost_func, gradient_func, alpha, iterat, lambda_):\n",
    "    examples = X.shape[0]\n",
    "    Cost_Journey = []\n",
    "    \n",
    "    for i in range(iterat):\n",
    "        dj_dw, dj_db = gradient_func(X, y, w_in, b_in, lambda_)\n",
    "        \n",
    "        w_in = w_in - alpha * dj_dw\n",
    "        b_in = b_in - alpha * dj_db\n",
    "        \n",
    "        if i % (iterat/10) == 0 or i == (iterat-1):\n",
    "            cost = cost_func(X, y, w_in, b_in, lambda_)\n",
    "            Cost_Journey.append(cost)\n",
    "            print(f\"Iteration {i:4}: Cost {float(Cost_Journey[-1]):8.2f}   \")\n",
    "    \n",
    "    return w_in, b_in, Cost_Journey"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "8a07b079",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Iteration    0: Cost     0.95   \n",
      "Iteration 1000: Cost     0.44   \n",
      "Iteration 2000: Cost     0.44   \n",
      "Iteration 3000: Cost     0.44   \n",
      "Iteration 4000: Cost     0.44   \n",
      "Iteration 5000: Cost     0.44   \n",
      "Iteration 6000: Cost     0.44   \n",
      "Iteration 7000: Cost     0.44   \n",
      "Iteration 8000: Cost     0.44   \n",
      "Iteration 9000: Cost     0.44   \n",
      "Iteration 9999: Cost     0.44   \n"
     ]
    }
   ],
   "source": [
    "alpha = 0.001\n",
    "iterations = 10000\n",
    "lambda_ = 0.01\n",
    "\n",
    "np.random.seed(1)\n",
    "i_w = np.random.rand(X_train.shape[1])-0.5\n",
    "i_b = 1.\n",
    "\n",
    "w,b, cost = compute_gradient(X_train, y_train, i_w, i_b, loss_calc, gradient_descent, alpha, iterations, lambda_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "5c5ab741",
   "metadata": {},
   "outputs": [],
   "source": [
    "def predict(X, w, b):\n",
    "    m,n = X.shape\n",
    "    p = np.zeros(m)\n",
    "    \n",
    "    for i in range(m):\n",
    "        kick = np.dot(X[i], w) + b\n",
    "        \n",
    "        if kick >= 0.5:\n",
    "            p[i] = 1\n",
    "        else:\n",
    "            p[i] = 0\n",
    "    \n",
    "    return p"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "6f20baf5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 81.460674\n"
     ]
    }
   ],
   "source": [
    "p_train = predict(X_train, w,b)\n",
    "print('Train Accuracy: %f'%(np.mean(p_train == y_train) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "a9737cec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 81.564246\n"
     ]
    }
   ],
   "source": [
    "p = predict(X_test, w,b)\n",
    "print('Train Accuracy: %f'%(np.mean(p == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "ff287cfd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.184\n",
      "error train: 0.185\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, p)\n",
    "error_train = eval_err(y_train, p_train)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "68b44584",
   "metadata": {},
   "source": [
    "## Result of Self-Made logistic Reg\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "be50e572",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.75      0.99      0.86        99\n",
      "           1       0.98      0.60      0.74        80\n",
      "\n",
      "    accuracy                           0.82       179\n",
      "   macro avg       0.87      0.79      0.80       179\n",
      "weighted avg       0.85      0.82      0.81       179\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test,p))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "ff570550",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[98  1]\n",
      " [32 48]]\n"
     ]
    }
   ],
   "source": [
    "print(confusion_matrix(y_test,p))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96d3364f",
   "metadata": {},
   "source": [
    "## Result of SKlearn logistic Reg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "7d8a87b8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.81      0.89      0.85        99\n",
      "           1       0.84      0.74      0.79        80\n",
      "\n",
      "    accuracy                           0.82       179\n",
      "   macro avg       0.83      0.81      0.82       179\n",
      "weighted avg       0.82      0.82      0.82       179\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test,pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "1e0f772a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[88 11]\n",
      " [21 59]]\n"
     ]
    }
   ],
   "source": [
    "print(confusion_matrix(y_test,pred))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4836d248",
   "metadata": {},
   "source": [
    "## Deep NN Model "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "579cddc3",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Import the TF package to test the performance\n",
    "import tensorflow as tf\n",
    "from tensorflow.keras.models import Sequential\n",
    "from tensorflow.keras.layers import Dense, Activation,Dropout\n",
    "from tensorflow.keras.losses import BinaryCrossentropy\n",
    "from tensorflow.keras.models import load_model\n",
    "from tensorflow.keras.callbacks import EarlyStopping"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 338,
   "id": "77fac65a",
   "metadata": {},
   "outputs": [],
   "source": [
    "model = Sequential(\n",
    "    [\n",
    "        tf.keras.Input(shape=(8,)),\n",
    "        Dense(units=32, activation='sigmoid'),\n",
    "        Dense(units=16, activation='sigmoid'),\n",
    "        Dense(units=1, activation='sigmoid'),\n",
    "    ], name=\"xx_model_NN_tit\")\n",
    "\n",
    "model.compile(optimizer=tf.keras.optimizers.Adam(0.001), loss=BinaryCrossentropy())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 339,
   "id": "9a63fcd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "early_stop = EarlyStopping(monitor='val_loss', mode='min', patience=25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 340,
   "id": "1c5e62d8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/1000\n",
      "23/23 [==============================] - 0s 4ms/step - loss: 0.6439 - val_loss: 0.6743\n",
      "Epoch 2/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.6325 - val_loss: 0.6667\n",
      "Epoch 3/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.6217 - val_loss: 0.6555\n",
      "Epoch 4/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.6108 - val_loss: 0.6342\n",
      "Epoch 5/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5957 - val_loss: 0.6226\n",
      "Epoch 6/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5809 - val_loss: 0.6042\n",
      "Epoch 7/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5659 - val_loss: 0.5865\n",
      "Epoch 8/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5495 - val_loss: 0.5679\n",
      "Epoch 9/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5345 - val_loss: 0.5502\n",
      "Epoch 10/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5208 - val_loss: 0.5399\n",
      "Epoch 11/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.5075 - val_loss: 0.5216\n",
      "Epoch 12/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4959 - val_loss: 0.5090\n",
      "Epoch 13/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4864 - val_loss: 0.4967\n",
      "Epoch 14/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4779 - val_loss: 0.4937\n",
      "Epoch 15/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4711 - val_loss: 0.4824\n",
      "Epoch 16/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4662 - val_loss: 0.4798\n",
      "Epoch 17/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4618 - val_loss: 0.4727\n",
      "Epoch 18/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4584 - val_loss: 0.4680\n",
      "Epoch 19/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4556 - val_loss: 0.4676\n",
      "Epoch 20/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4530 - val_loss: 0.4662\n",
      "Epoch 21/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4515 - val_loss: 0.4623\n",
      "Epoch 22/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4499 - val_loss: 0.4596\n",
      "Epoch 23/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4489 - val_loss: 0.4596\n",
      "Epoch 24/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4485 - val_loss: 0.4584\n",
      "Epoch 25/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4466 - val_loss: 0.4529\n",
      "Epoch 26/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4466 - val_loss: 0.4537\n",
      "Epoch 27/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4457 - val_loss: 0.4506\n",
      "Epoch 28/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4451 - val_loss: 0.4555\n",
      "Epoch 29/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4444 - val_loss: 0.4511\n",
      "Epoch 30/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4444 - val_loss: 0.4603\n",
      "Epoch 31/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4440 - val_loss: 0.4499\n",
      "Epoch 32/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4428 - val_loss: 0.4535\n",
      "Epoch 33/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4423 - val_loss: 0.4512\n",
      "Epoch 34/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4424 - val_loss: 0.4500\n",
      "Epoch 35/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4423 - val_loss: 0.4501\n",
      "Epoch 36/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4420 - val_loss: 0.4469\n",
      "Epoch 37/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4413 - val_loss: 0.4513\n",
      "Epoch 38/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4413 - val_loss: 0.4504\n",
      "Epoch 39/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4410 - val_loss: 0.4492\n",
      "Epoch 40/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4408 - val_loss: 0.4547\n",
      "Epoch 41/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4403 - val_loss: 0.4501\n",
      "Epoch 42/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4399 - val_loss: 0.4484\n",
      "Epoch 43/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4402 - val_loss: 0.4464\n",
      "Epoch 44/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4395 - val_loss: 0.4475\n",
      "Epoch 45/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4398 - val_loss: 0.4436\n",
      "Epoch 46/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4392 - val_loss: 0.4468\n",
      "Epoch 47/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4386 - val_loss: 0.4496\n",
      "Epoch 48/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4386 - val_loss: 0.4457\n",
      "Epoch 49/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4380 - val_loss: 0.4474\n",
      "Epoch 50/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4392 - val_loss: 0.4438\n",
      "Epoch 51/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4379 - val_loss: 0.4485\n",
      "Epoch 52/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4385 - val_loss: 0.4480\n",
      "Epoch 53/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4386 - val_loss: 0.4423\n",
      "Epoch 54/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4379 - val_loss: 0.4464\n",
      "Epoch 55/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4377 - val_loss: 0.4442\n",
      "Epoch 56/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4366 - val_loss: 0.4467\n",
      "Epoch 57/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4369 - val_loss: 0.4465\n",
      "Epoch 58/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4373 - val_loss: 0.4385\n",
      "Epoch 59/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4369 - val_loss: 0.4471\n",
      "Epoch 60/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4357 - val_loss: 0.4430\n",
      "Epoch 61/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4368 - val_loss: 0.4370\n",
      "Epoch 62/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4359 - val_loss: 0.4475\n",
      "Epoch 63/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4355 - val_loss: 0.4435\n",
      "Epoch 64/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4354 - val_loss: 0.4398\n",
      "Epoch 65/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4350 - val_loss: 0.4421\n",
      "Epoch 66/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4347 - val_loss: 0.4413\n",
      "Epoch 67/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4347 - val_loss: 0.4408\n",
      "Epoch 68/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4344 - val_loss: 0.4384\n",
      "Epoch 69/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4339 - val_loss: 0.4417\n",
      "Epoch 70/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4343 - val_loss: 0.4401\n",
      "Epoch 71/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4337 - val_loss: 0.4388\n",
      "Epoch 72/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4336 - val_loss: 0.4393\n",
      "Epoch 73/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4333 - val_loss: 0.4402\n",
      "Epoch 74/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4330 - val_loss: 0.4386\n",
      "Epoch 75/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4331 - val_loss: 0.4375\n",
      "Epoch 76/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4326 - val_loss: 0.4396\n",
      "Epoch 77/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4320 - val_loss: 0.4369\n",
      "Epoch 78/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4323 - val_loss: 0.4384\n",
      "Epoch 79/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4321 - val_loss: 0.4371\n",
      "Epoch 80/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4326 - val_loss: 0.4371\n",
      "Epoch 81/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4315 - val_loss: 0.4402\n",
      "Epoch 82/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4311 - val_loss: 0.4360\n",
      "Epoch 83/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4320 - val_loss: 0.4350\n",
      "Epoch 84/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4316 - val_loss: 0.4417\n",
      "Epoch 85/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4307 - val_loss: 0.4344\n",
      "Epoch 86/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4309 - val_loss: 0.4379\n",
      "Epoch 87/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4304 - val_loss: 0.4357\n",
      "Epoch 88/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4307 - val_loss: 0.4354\n",
      "Epoch 89/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4309 - val_loss: 0.4374\n",
      "Epoch 90/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4301 - val_loss: 0.4323\n",
      "Epoch 91/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4295 - val_loss: 0.4390\n",
      "Epoch 92/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4295 - val_loss: 0.4354\n",
      "Epoch 93/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4296 - val_loss: 0.4334\n",
      "Epoch 94/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4295 - val_loss: 0.4359\n",
      "Epoch 95/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4296 - val_loss: 0.4357\n",
      "Epoch 96/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4289 - val_loss: 0.4358\n",
      "Epoch 97/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4283 - val_loss: 0.4343\n",
      "Epoch 98/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4282 - val_loss: 0.4323\n",
      "Epoch 99/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4280 - val_loss: 0.4337\n",
      "Epoch 100/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4279 - val_loss: 0.4346\n",
      "Epoch 101/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4277 - val_loss: 0.4337\n",
      "Epoch 102/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4282 - val_loss: 0.4377\n",
      "Epoch 103/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4276 - val_loss: 0.4367\n",
      "Epoch 104/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4273 - val_loss: 0.4350\n",
      "Epoch 105/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4276 - val_loss: 0.4319\n",
      "Epoch 106/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4269 - val_loss: 0.4363\n",
      "Epoch 107/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4268 - val_loss: 0.4354\n",
      "Epoch 108/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4265 - val_loss: 0.4309\n",
      "Epoch 109/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4265 - val_loss: 0.4337\n",
      "Epoch 110/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4263 - val_loss: 0.4324\n",
      "Epoch 111/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4265 - val_loss: 0.4358\n",
      "Epoch 112/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4259 - val_loss: 0.4311\n",
      "Epoch 113/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4267 - val_loss: 0.4281\n",
      "Epoch 114/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4259 - val_loss: 0.4340\n",
      "Epoch 115/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4259 - val_loss: 0.4379\n",
      "Epoch 116/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4254 - val_loss: 0.4285\n",
      "Epoch 117/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4257 - val_loss: 0.4273\n",
      "Epoch 118/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4250 - val_loss: 0.4292\n",
      "Epoch 119/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4245 - val_loss: 0.4310\n",
      "Epoch 120/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4249 - val_loss: 0.4278\n",
      "Epoch 121/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4244 - val_loss: 0.4345\n",
      "Epoch 122/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4248 - val_loss: 0.4279\n",
      "Epoch 123/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4240 - val_loss: 0.4349\n",
      "Epoch 124/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4245 - val_loss: 0.4324\n",
      "Epoch 125/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4246 - val_loss: 0.4362\n",
      "Epoch 126/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4242 - val_loss: 0.4248\n",
      "Epoch 127/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4238 - val_loss: 0.4301\n",
      "Epoch 128/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4233 - val_loss: 0.4310\n",
      "Epoch 129/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4232 - val_loss: 0.4291\n",
      "Epoch 130/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4229 - val_loss: 0.4279\n",
      "Epoch 131/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4231 - val_loss: 0.4285\n",
      "Epoch 132/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4228 - val_loss: 0.4291\n",
      "Epoch 133/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4228 - val_loss: 0.4261\n",
      "Epoch 134/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4225 - val_loss: 0.4281\n",
      "Epoch 135/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4224 - val_loss: 0.4266\n",
      "Epoch 136/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4223 - val_loss: 0.4294\n",
      "Epoch 137/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4220 - val_loss: 0.4293\n",
      "Epoch 138/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4218 - val_loss: 0.4270\n",
      "Epoch 139/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4223 - val_loss: 0.4252\n",
      "Epoch 140/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4218 - val_loss: 0.4271\n",
      "Epoch 141/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4213 - val_loss: 0.4262\n",
      "Epoch 142/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4214 - val_loss: 0.4266\n",
      "Epoch 143/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4216 - val_loss: 0.4274\n",
      "Epoch 144/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4210 - val_loss: 0.4264\n",
      "Epoch 145/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4208 - val_loss: 0.4286\n",
      "Epoch 146/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4220 - val_loss: 0.4277\n",
      "Epoch 147/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4205 - val_loss: 0.4283\n",
      "Epoch 148/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4205 - val_loss: 0.4291\n",
      "Epoch 149/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4208 - val_loss: 0.4259\n",
      "Epoch 150/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4206 - val_loss: 0.4280\n",
      "Epoch 151/1000\n",
      "23/23 [==============================] - 0s 1ms/step - loss: 0.4206 - val_loss: 0.4254\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<keras.callbacks.History at 0x1ea370e03d0>"
      ]
     },
     "execution_count": 340,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(x=X_train, y=y_train, epochs=1000, validation_data=(X_test, y_test), callbacks=[early_stop])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 309,
   "id": "25e92aca",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 309,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "loss_mol = pd.DataFrame(model.history.history)\n",
    "loss_mol.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 341,
   "id": "2753d203",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1/1 [==============================] - 0s 26ms/step\n",
      "[[0.20287956]]\n"
     ]
    }
   ],
   "source": [
    "pred_0 = model.predict(X_train[0].reshape(1,8))\n",
    "print(pred_0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8f13cfca",
   "metadata": {},
   "outputs": [],
   "source": [
    "def NN_pred(yhat):\n",
    "    if yhat >= 0.5:\n",
    "        return 1\n",
    "    else:\n",
    "        return 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "5ba39d82",
   "metadata": {},
   "outputs": [],
   "source": [
    "def eval_err(y, yhat):\n",
    "    m = y.shape[0]\n",
    "    incorrect = 0\n",
    "    y = y.tolist()\n",
    "    for i in range(m):\n",
    "        if yhat[i] != y[i]:\n",
    "            incorrect += 1\n",
    "            \n",
    "    incorrect = incorrect / m\n",
    "    \n",
    "    return incorrect "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 342,
   "id": "802f9a61",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6/6 [==============================] - 0s 600us/step - loss: 0.4254\n",
      "0.42539092898368835\n"
     ]
    }
   ],
   "source": [
    "results = model.evaluate(X_test, y_test)\n",
    "print(results)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 343,
   "id": "75fea1cc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6/6 [==============================] - 0s 400us/step\n"
     ]
    }
   ],
   "source": [
    "prediction_nn = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "28dde994",
   "metadata": {},
   "outputs": [],
   "source": [
    "def pred_output(prediction):\n",
    "    ex = prediction.shape[0]\n",
    "    output = []\n",
    "    for i in range(ex):\n",
    "        output.append(NN_pred(prediction[i]))\n",
    "    \n",
    "    return output"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 344,
   "id": "3996aabf",
   "metadata": {},
   "outputs": [],
   "source": [
    "output = pred_output(prediction_nn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 345,
   "id": "95147f5d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 82.681564\n"
     ]
    }
   ],
   "source": [
    "print('Train Accuracy: %f'%(np.mean(output == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 346,
   "id": "61c0d7d0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "23/23 [==============================] - 0s 409us/step\n"
     ]
    }
   ],
   "source": [
    "output_train = pred_output(model.predict(X_train))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 347,
   "id": "1681e48f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.173\n",
      "error train: 0.180\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, output)\n",
    "error_train = eval_err(y_train, output_train)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 348,
   "id": "9ccd54ba",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.78      0.95      0.86        99\n",
      "           1       0.92      0.68      0.78        80\n",
      "\n",
      "    accuracy                           0.83       179\n",
      "   macro avg       0.85      0.81      0.82       179\n",
      "weighted avg       0.84      0.83      0.82       179\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test, output))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 349,
   "id": "6fd9811d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[94  5]\n",
      " [26 54]]\n"
     ]
    }
   ],
   "source": [
    "print(confusion_matrix(y_test, output))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 350,
   "id": "a4800eee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"xx_model_NN_tit\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " dense_27 (Dense)            (None, 32)                288       \n",
      "                                                                 \n",
      " dense_28 (Dense)            (None, 16)                528       \n",
      "                                                                 \n",
      " dense_29 (Dense)            (None, 1)                 17        \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 833\n",
      "Trainable params: 833\n",
      "Non-trainable params: 0\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 288,
   "id": "6f935fee",
   "metadata": {},
   "outputs": [],
   "source": [
    "model.save('Model_tf_NN_tit.h5')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b011009",
   "metadata": {},
   "source": [
    "## Building a Deep NN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "id": "017a25b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Create code that runs per layer:\n",
    "    #Every node uses its weights and np.dots(x, w) + b // Uses the result in the sigmoid function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "id": "b0d55124",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.49876844632347345"
      ]
     },
     "execution_count": 238,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sigmoid(-0.0049262246684229904)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 351,
   "id": "5140b873",
   "metadata": {},
   "outputs": [],
   "source": [
    "[l1, l2, l3] = model.layers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 352,
   "id": "24e9cd4b",
   "metadata": {},
   "outputs": [],
   "source": [
    "W1_tmp, b1_tmp = l1.get_weights()\n",
    "W2_tmp, b2_tmp = l2.get_weights()\n",
    "W3_tmp, b3_tmp = l3.get_weights()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 353,
   "id": "eaf9b1da",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(8, 32)\n",
      "(32, 16)\n",
      "(16, 1)\n",
      "(712, 8)\n",
      "(179, 8)\n"
     ]
    }
   ],
   "source": [
    "print(W1_tmp.shape)\n",
    "print(W2_tmp.shape)\n",
    "print(W3_tmp.shape)\n",
    "print(X_train.shape)\n",
    "print(X_test.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 354,
   "id": "326691a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "def layers(a_in, W, b, g):\n",
    "    #Use the input a_in\n",
    "    units = W.shape[1]\n",
    "    a_out = np.zeros(units)\n",
    "    \n",
    "    for i in range(units):\n",
    "        res = np.dot(W[:,i], a_in) + b[i]\n",
    "        a_out[i] = g(res)\n",
    "        \n",
    "    return a_out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 355,
   "id": "7684e985",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sequential(x, W1, b1, W2, b2, W3, b3, g):\n",
    "    a1 = layers(x, W1, b1, g)\n",
    "    a2 = layers(a1, W2, b2, g)\n",
    "    a3 = layers(a2, W3, b3, g)\n",
    "    \n",
    "    return a3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 359,
   "id": "64685435",
   "metadata": {},
   "outputs": [],
   "source": [
    "def run_nn_built(X):\n",
    "    ## Get No examples to run prediction\n",
    "    examples = X.shape[0]\n",
    "    prediction_nn_built = np.zeros(examples)\n",
    "    \n",
    "    for i in range(examples):\n",
    "        ## Iterate over all examples and add it to prediction\n",
    "        prob = sequential(X[i], W1_tmp, b1_tmp, W2_tmp, b2_tmp, W3_tmp, b3_tmp, g=sigmoid)\n",
    "        \n",
    "        if prob >= 0.5:\n",
    "            prob = 1\n",
    "        else:\n",
    "            prob = 0\n",
    "            \n",
    "        prediction_nn_built[i] = prob\n",
    "        \n",
    "    return prediction_nn_built"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 373,
   "id": "5dcbb701",
   "metadata": {},
   "outputs": [],
   "source": [
    "#prediction_xn = sequential(X_train[0], W1_tmp, b1_tmp, W2_tmp, b2_tmp, W3_tmp, b3_tmp, W4_tmp, b4_tmp, g=sigmoid)\n",
    "#print(prediction_xn)\n",
    "pred_nn_built = run_nn_built(X_train)\n",
    "pred_nn_built_test = run_nn_built(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 361,
   "id": "ab7add5c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.173\n",
      "error train: 0.180\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, pred_nn_built_test)\n",
    "error_train = eval_err(y_train, pred_nn_built)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 362,
   "id": "23527b4a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 82.681564\n"
     ]
    }
   ],
   "source": [
    "print('Train Accuracy: %f'%(np.mean(pred_nn_built_test == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 363,
   "id": "25e09920",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.78      0.95      0.86        99\n",
      "           1       0.92      0.68      0.78        80\n",
      "\n",
      "    accuracy                           0.83       179\n",
      "   macro avg       0.85      0.81      0.82       179\n",
      "weighted avg       0.84      0.83      0.82       179\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test, pred_nn_built_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 365,
   "id": "99982349",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[94  5]\n",
      " [26 54]]\n"
     ]
    }
   ],
   "source": [
    "print(confusion_matrix(y_test, pred_nn_built_test))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c27387e6",
   "metadata": {},
   "source": [
    "## Improving the calculation time using matmul instead of np.dot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 367,
   "id": "32a952c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def layers_matmul(a_in, W, b, g):\n",
    "    #Use the input a_in\n",
    "    \n",
    "    res = np.matmul(a_in, W) + b\n",
    "    a_out[i] = g(res)\n",
    "        \n",
    "    return a_out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 368,
   "id": "9b6704e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sequential_matmul(x, W1, b1, W2, b2, W3, b3, g):\n",
    "    a1 = layers_matmul(x, W1, b1, g)\n",
    "    a2 = layers_matmul(a1, W2, b2, g)\n",
    "    a3 = layers_matmul(a2, W3, b3, g)\n",
    "    \n",
    "    return a3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 370,
   "id": "8a0f5edf",
   "metadata": {},
   "outputs": [],
   "source": [
    "def run_nn_built_matmul(X):\n",
    "    ## Get No examples to run prediction\n",
    "    examples = X.shape[0]\n",
    "    prediction_nn_built = np.zeros(examples)\n",
    "    \n",
    "    for i in range(examples):\n",
    "        ## Iterate over all examples and add it to prediction\n",
    "        prob = sequential_matmul(X[i], W1_tmp, b1_tmp, W2_tmp, b2_tmp, W3_tmp, b3_tmp, g=sigmoid)\n",
    "        \n",
    "        if prob >= 0.5:\n",
    "            prob = 1\n",
    "        else:\n",
    "            prob = 0\n",
    "            \n",
    "        prediction_nn_built[i] = prob\n",
    "        \n",
    "    return prediction_nn_built"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 375,
   "id": "12123bff",
   "metadata": {},
   "outputs": [],
   "source": [
    "pred_nn_built_matmul = run_nn_built(X_train)\n",
    "pred_nn_built_test_matmul = run_nn_built(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 377,
   "id": "415490a1",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.173\n",
      "error train: 0.180\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, pred_nn_built_test_matmul)\n",
    "error_train = eval_err(y_train, pred_nn_built_matmul)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 379,
   "id": "9558e794",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train Accuracy: 82.681564\n"
     ]
    }
   ],
   "source": [
    "print('Train Accuracy: %f'%(np.mean(pred_nn_built_test_matmul == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 386,
   "id": "7feae30a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8268156424581006"
      ]
     },
     "execution_count": 386,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test, pred_nn_built_test_matmul)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f9a656de",
   "metadata": {},
   "source": [
    "## Using XGBoost"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f077a1f4",
   "metadata": {},
   "source": [
    "Reference:\n",
    "https://towardsdatascience.com/beginners-guide-to-xgboost-for-classification-problems-50f75aac5390"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 340,
   "id": "ffe37b7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import xgboost as xgb\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.model_selection import GridSearchCV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 376,
   "id": "afeb0f3d",
   "metadata": {},
   "outputs": [],
   "source": [
    "xgb_model = xgb.XGBClassifier()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 377,
   "id": "d4156c9d",
   "metadata": {},
   "outputs": [],
   "source": [
    "xgb_model.fit(X_train, y_train)\n",
    "pred_xgb_model = xgb_model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 378,
   "id": "75e31ea2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.8212290502793296\n",
      "Train Accuracy: 82.122905\n"
     ]
    }
   ],
   "source": [
    "print(accuracy_score(y_test, pred_xgb_model))\n",
    "print('Train Accuracy: %f'%(np.mean(pred_xgb_model == y_test) * 100))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 379,
   "id": "7cf0158d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "XGBClassifier(base_score=0.5, booster='gbtree', callbacks=None,\n",
       "              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n",
       "              early_stopping_rounds=None, enable_categorical=False,\n",
       "              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n",
       "              importance_type=None, interaction_constraints='',\n",
       "              learning_rate=0.300000012, max_bin=256, max_cat_to_onehot=4,\n",
       "              max_delta_step=0, max_depth=6, max_leaves=0, min_child_weight=1,\n",
       "              missing=nan, monotone_constraints='()', n_estimators=100,\n",
       "              n_jobs=0, num_parallel_tree=1, predictor='auto', random_state=0,\n",
       "              reg_alpha=0, reg_lambda=1, ...)"
      ]
     },
     "execution_count": 379,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xgb_model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 380,
   "id": "049638e0",
   "metadata": {},
   "outputs": [],
   "source": [
    "param_grid = {\n",
    "    \"max_depth\": [3, 4, 5, 7],\n",
    "    \"learning_rate\": [0.1, 0.05, 0.01],\n",
    "    \"gamma\": [0, 0.25, 1],\n",
    "    \"reg_lambda\": [0, 1, 10],\n",
    "    \"scale_pos_weight\": [1, 3, 5],\n",
    "    \"subsample\": [0.8],\n",
    "    \"colsample_bytree\": [0.5],\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 382,
   "id": "5ac1e298",
   "metadata": {},
   "outputs": [],
   "source": [
    "grid_cv = GridSearchCV(xgb_model, param_grid, n_jobs=-1, verbose=1, cv=3, scoring='roc_auc')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 383,
   "id": "6197cd67",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitting 3 folds for each of 324 candidates, totalling 972 fits\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "GridSearchCV(cv=3,\n",
       "             estimator=XGBClassifier(base_score=0.5, booster='gbtree',\n",
       "                                     callbacks=None, colsample_bylevel=1,\n",
       "                                     colsample_bynode=1, colsample_bytree=1,\n",
       "                                     early_stopping_rounds=None,\n",
       "                                     enable_categorical=False, eval_metric=None,\n",
       "                                     gamma=0, gpu_id=-1,\n",
       "                                     grow_policy='depthwise',\n",
       "                                     importance_type=None,\n",
       "                                     interaction_constraints='',\n",
       "                                     learning_rate=0.300000012, max_bin=256,\n",
       "                                     max_ca...\n",
       "                                     monotone_constraints='()',\n",
       "                                     n_estimators=100, n_jobs=0,\n",
       "                                     num_parallel_tree=1, predictor='auto',\n",
       "                                     random_state=0, reg_alpha=0, reg_lambda=1, ...),\n",
       "             n_jobs=-1,\n",
       "             param_grid={'colsample_bytree': [0.5], 'gamma': [0, 0.25, 1],\n",
       "                         'learning_rate': [0.1, 0.05, 0.01],\n",
       "                         'max_depth': [3, 4, 5, 7], 'reg_lambda': [0, 1, 10],\n",
       "                         'scale_pos_weight': [1, 3, 5], 'subsample': [0.8]},\n",
       "             scoring='roc_auc', verbose=1)"
      ]
     },
     "execution_count": 383,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grid_cv.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 384,
   "id": "2875deaf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8521506734006734"
      ]
     },
     "execution_count": 384,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grid_cv.best_score_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 385,
   "id": "756ff49d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'colsample_bytree': 0.5,\n",
       " 'gamma': 0,\n",
       " 'learning_rate': 0.05,\n",
       " 'max_depth': 4,\n",
       " 'reg_lambda': 0,\n",
       " 'scale_pos_weight': 3,\n",
       " 'subsample': 0.8}"
      ]
     },
     "execution_count": 385,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grid_cv.best_params_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 386,
   "id": "42e650e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_model = xgb.XGBClassifier(**grid_cv.best_params_, objective=\"binary:logistic\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 387,
   "id": "bfc74539",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "XGBClassifier(base_score=0.5, booster='gbtree', callbacks=None,\n",
       "              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=0.5,\n",
       "              early_stopping_rounds=None, enable_categorical=False,\n",
       "              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n",
       "              importance_type=None, interaction_constraints='',\n",
       "              learning_rate=0.05, max_bin=256, max_cat_to_onehot=4,\n",
       "              max_delta_step=0, max_depth=4, max_leaves=0, min_child_weight=1,\n",
       "              missing=nan, monotone_constraints='()', n_estimators=100,\n",
       "              n_jobs=0, num_parallel_tree=1, predictor='auto', random_state=0,\n",
       "              reg_alpha=0, reg_lambda=0, ...)"
      ]
     },
     "execution_count": 387,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_model.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 388,
   "id": "e3574397",
   "metadata": {},
   "outputs": [],
   "source": [
    "pred_xg_test = final_model.predict(X_test)\n",
    "pred_xg_train = final_model.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 389,
   "id": "5ae197a8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "error cv:    0.173\n",
      "error train: 0.183\n"
     ]
    }
   ],
   "source": [
    "error_cv = eval_err(y_test, pred_xg_test)\n",
    "error_train = eval_err(y_train, pred_xg_train)\n",
    "print(f\"error cv:    {error_cv :0.3f}\")\n",
    "print(f\"error train: {error_train :0.3f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 390,
   "id": "6beec355",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Test Accuracy: 82.681564\n"
     ]
    }
   ],
   "source": [
    "print('Test Accuracy: %f'%(np.mean(pred_xg_test == y_test) * 100))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "85ab92cf",
   "metadata": {},
   "source": [
    "## Building a Decision Tree Classifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "9ba65f1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Calculate entropy at y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 467,
   "id": "c4a42480",
   "metadata": {},
   "outputs": [],
   "source": [
    "def calculate_entropy(y):\n",
    "    \n",
    "    m = len(y)\n",
    "    entropy = 0.\n",
    "    p1 = 0\n",
    "    ## Size must be bigger than 0\n",
    "    if m <= 0:\n",
    "        return entropy\n",
    "    # Iterate over examples to get p1 (ratio of elements that are positive == 1)\n",
    "    for i in range(m):\n",
    "        if y[i] == 1:\n",
    "            p1 += 1\n",
    "    ## Getting p1 and, by consequence, p2\n",
    "    p1 = p1 / m\n",
    "    p2 = 1 - p1\n",
    "    \n",
    "    if p1 == 1 or p1 == 0:\n",
    "        return entropy\n",
    "    else:\n",
    "        #Calculating entropy when p1 is not 0 or 1 (becaus of log2(0) == inf.)\n",
    "        entropy = (-p1* np.log2(p1)) - (p2 * np.log2(p2))\n",
    "        \n",
    "        return entropy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 468,
   "id": "7b4c0f37",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9491065174123546"
      ]
     },
     "execution_count": 468,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "calculate_entropy(y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 204,
   "id": "a6ed998f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Splitting dataset - using current data to split between left and right branches"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 469,
   "id": "b85196c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[1, 0, 1, ..., 0, 0, 0],\n",
       "       [1, 0, 1, ..., 0, 0, 0],\n",
       "       [1, 0, 1, ..., 0, 0, 0],\n",
       "       ...,\n",
       "       [0, 0, 0, ..., 0, 0, 0],\n",
       "       [0, 0, 0, ..., 0, 0, 0],\n",
       "       [0, 0, 1, ..., 0, 0, 0]], dtype=int64)"
      ]
     },
     "execution_count": 469,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 470,
   "id": "b5486793",
   "metadata": {},
   "outputs": [],
   "source": [
    "def split_data(X, feature, root_index):\n",
    "    \n",
    "    m = X.shape[0]\n",
    "    left_branch = []\n",
    "    right_branch = []\n",
    "    \n",
    "    for i in range(m):\n",
    "        if X[i][feature] == 1:\n",
    "            left_branch.append(i)\n",
    "        else:\n",
    "            right_branch.append(i)\n",
    "            \n",
    "    return left_branch, right_branch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 471,
   "id": "59fb03f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "root_index = np.arange(0, X_train.shape[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 472,
   "id": "c3f8cdf8",
   "metadata": {},
   "outputs": [],
   "source": [
    "def info_gain(X, y, feature, node_indices):\n",
    "    \n",
    "    info_gain = 0.\n",
    "    \n",
    "    left, right = split_data(X, feature, node_indices)\n",
    "    \n",
    "    p1_entr = calculate_entropy(y[node_indices])\n",
    "    left_entr = calculate_entropy(y[left])\n",
    "    right_entr = calculate_entropy(y[right])\n",
    "    \n",
    "    weight_lef = len(left)/ (len(right) + len(left))\n",
    "    weight_ri = 1 - weight_lef\n",
    "    \n",
    "    info_gain = p1_entr - (weight_lef * left_entr + right_entr * weight_ri)\n",
    "    \n",
    "    return info_gain"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 473,
   "id": "90b3275e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.20821002408308886"
      ]
     },
     "execution_count": 473,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "info_gain(X_train, y_train, 0, root_index)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 474,
   "id": "1c6a4c98",
   "metadata": {},
   "outputs": [],
   "source": [
    "def best_split(X, y, node_indices):\n",
    "    m, n = X.shape\n",
    "    \n",
    "    best_feature = -1\n",
    "    aux = 0\n",
    "    gain_hist = []\n",
    "    \n",
    "    for i in range(n):\n",
    "        gain = info_gain(X, y, i, node_indices)\n",
    "        gain_hist.append(gain)\n",
    "        if gain > aux:\n",
    "            best_feature = i\n",
    "            aux = gain\n",
    "    \n",
    "    return best_feature, gain_hist"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 475,
   "id": "c358c3bc",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0\n",
      "68\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "best_feature, gain_hist = best_split(X_train, y_train, root_index)\n",
    "print(best_feature)\n",
    "plt.plot(gain_hist)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 498,
   "id": "fa4ce575",
   "metadata": {},
   "outputs": [],
   "source": [
    "tree = []\n",
    "\n",
    "def build_tree_rec(X, y, node_indices, max_depth, current_depth, b_name):\n",
    "\n",
    "    if current_depth == max_depth:\n",
    "        formatting = \" \"*current_depth + \"-\"*current_depth\n",
    "        print(formatting, \"%s leaf node with indices\" % b_name, node_indices[:3])\n",
    "        return\n",
    "    \n",
    "    bf, gh = best_split(X, y, node_indices)\n",
    "    \n",
    "    tree.append((current_depth, b_name, bf, node_indices))\n",
    "    \n",
    "    formatting = \"-\"*current_depth\n",
    "    print(\"%s Depth %d, %s: Split on feature: %d\" % (formatting, current_depth, b_name, best_feature))\n",
    "    \n",
    "    left, right = split_data(X, bf, node_indices)\n",
    "    \n",
    "    build_tree_rec(X, y, left, max_depth, current_depth+1, \"Left\")\n",
    "    build_tree_rec(X, y, right, max_depth, current_depth+1, \"Right\")\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 499,
   "id": "950c205c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      " Depth 0, Root: Split on feature: 0\n",
      "- Depth 1, Left: Split on feature: 0\n",
      "  -- Left leaf node with indices [275, 383, 527]\n",
      "  -- Right leaf node with indices [0, 1, 2]\n",
      "- Depth 1, Right: Split on feature: 0\n",
      "  -- Left leaf node with indices [0, 1, 2]\n",
      "  -- Right leaf node with indices [3, 4, 5]\n"
     ]
    }
   ],
   "source": [
    "build_tree_rec(X_train, y_train, root_index, 2, 0, \"Root\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 514,
   "id": "f2167138",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[0,\n",
       " 1,\n",
       " 2,\n",
       " 6,\n",
       " 7,\n",
       " 9,\n",
       " 10,\n",
       " 11,\n",
       " 12,\n",
       " 13,\n",
       " 15,\n",
       " 16,\n",
       " 17,\n",
       " 19,\n",
       " 20,\n",
       " 21,\n",
       " 22,\n",
       " 23,\n",
       " 25,\n",
       " 27,\n",
       " 30,\n",
       " 31,\n",
       " 32,\n",
       " 33,\n",
       " 34,\n",
       " 36,\n",
       " 37,\n",
       " 39,\n",
       " 42,\n",
       " 43,\n",
       " 45,\n",
       " 47,\n",
       " 48,\n",
       " 49,\n",
       " 50,\n",
       " 51,\n",
       " 52,\n",
       " 55,\n",
       " 56,\n",
       " 57,\n",
       " 60,\n",
       " 61,\n",
       " 63,\n",
       " 64,\n",
       " 67,\n",
       " 68,\n",
       " 71,\n",
       " 73,\n",
       " 74,\n",
       " 75,\n",
       " 76,\n",
       " 77,\n",
       " 78,\n",
       " 80,\n",
       " 81,\n",
       " 83,\n",
       " 84,\n",
       " 86,\n",
       " 87,\n",
       " 90,\n",
       " 95,\n",
       " 98,\n",
       " 99,\n",
       " 101,\n",
       " 103,\n",
       " 104,\n",
       " 105,\n",
       " 106,\n",
       " 107,\n",
       " 109,\n",
       " 110,\n",
       " 111,\n",
       " 112,\n",
       " 113,\n",
       " 115,\n",
       " 116,\n",
       " 118,\n",
       " 121,\n",
       " 122,\n",
       " 123,\n",
       " 124,\n",
       " 125,\n",
       " 126,\n",
       " 127,\n",
       " 130,\n",
       " 131,\n",
       " 133,\n",
       " 135,\n",
       " 137,\n",
       " 138,\n",
       " 140,\n",
       " 141,\n",
       " 144,\n",
       " 145,\n",
       " 146,\n",
       " 147,\n",
       " 148,\n",
       " 151,\n",
       " 152,\n",
       " 155,\n",
       " 156,\n",
       " 157,\n",
       " 158,\n",
       " 159,\n",
       " 162,\n",
       " 163,\n",
       " 165,\n",
       " 167,\n",
       " 168,\n",
       " 169,\n",
       " 170,\n",
       " 171,\n",
       " 172,\n",
       " 174,\n",
       " 175,\n",
       " 176,\n",
       " 178,\n",
       " 179,\n",
       " 182,\n",
       " 184,\n",
       " 185,\n",
       " 187,\n",
       " 188,\n",
       " 189,\n",
       " 190,\n",
       " 193,\n",
       " 194,\n",
       " 195,\n",
       " 196,\n",
       " 197,\n",
       " 198,\n",
       " 200,\n",
       " 201,\n",
       " 202,\n",
       " 204,\n",
       " 205,\n",
       " 206,\n",
       " 207,\n",
       " 208,\n",
       " 210,\n",
       " 212,\n",
       " 213,\n",
       " 214,\n",
       " 215,\n",
       " 216,\n",
       " 217,\n",
       " 219,\n",
       " 220,\n",
       " 221,\n",
       " 222,\n",
       " 224,\n",
       " 226,\n",
       " 227,\n",
       " 228,\n",
       " 229,\n",
       " 230,\n",
       " 231,\n",
       " 232,\n",
       " 233,\n",
       " 235,\n",
       " 236,\n",
       " 238,\n",
       " 239,\n",
       " 240,\n",
       " 241,\n",
       " 242,\n",
       " 243,\n",
       " 246,\n",
       " 247,\n",
       " 248,\n",
       " 249,\n",
       " 250,\n",
       " 251,\n",
       " 252,\n",
       " 253,\n",
       " 254,\n",
       " 260,\n",
       " 261,\n",
       " 262,\n",
       " 265,\n",
       " 267,\n",
       " 268,\n",
       " 269,\n",
       " 270,\n",
       " 271,\n",
       " 272,\n",
       " 274,\n",
       " 276,\n",
       " 280,\n",
       " 281,\n",
       " 283,\n",
       " 284,\n",
       " 285,\n",
       " 286,\n",
       " 287,\n",
       " 288,\n",
       " 290,\n",
       " 291,\n",
       " 292,\n",
       " 293,\n",
       " 294,\n",
       " 295,\n",
       " 296,\n",
       " 297,\n",
       " 298,\n",
       " 299,\n",
       " 302,\n",
       " 304,\n",
       " 306,\n",
       " 307,\n",
       " 310,\n",
       " 311,\n",
       " 312,\n",
       " 314,\n",
       " 315,\n",
       " 317,\n",
       " 318,\n",
       " 319,\n",
       " 320,\n",
       " 321,\n",
       " 324,\n",
       " 328,\n",
       " 330,\n",
       " 331,\n",
       " 332,\n",
       " 335,\n",
       " 336,\n",
       " 337,\n",
       " 338,\n",
       " 341,\n",
       " 342,\n",
       " 343,\n",
       " 345,\n",
       " 347,\n",
       " 349,\n",
       " 351,\n",
       " 352,\n",
       " 356,\n",
       " 357,\n",
       " 359,\n",
       " 360,\n",
       " 362,\n",
       " 363,\n",
       " 364,\n",
       " 365,\n",
       " 366,\n",
       " 368,\n",
       " 369,\n",
       " 370,\n",
       " 371,\n",
       " 372,\n",
       " 373,\n",
       " 375,\n",
       " 376,\n",
       " 378,\n",
       " 379,\n",
       " 381,\n",
       " 382,\n",
       " 383,\n",
       " 385,\n",
       " 386,\n",
       " 387,\n",
       " 389,\n",
       " 390,\n",
       " 391,\n",
       " 392,\n",
       " 394,\n",
       " 397,\n",
       " 398,\n",
       " 400,\n",
       " 402,\n",
       " 403,\n",
       " 404,\n",
       " 405,\n",
       " 406,\n",
       " 407,\n",
       " 408,\n",
       " 410,\n",
       " 411,\n",
       " 413,\n",
       " 414,\n",
       " 415,\n",
       " 416,\n",
       " 418,\n",
       " 421,\n",
       " 422,\n",
       " 425,\n",
       " 427,\n",
       " 428,\n",
       " 430,\n",
       " 434,\n",
       " 435,\n",
       " 436,\n",
       " 438,\n",
       " 440,\n",
       " 442,\n",
       " 444,\n",
       " 446,\n",
       " 448,\n",
       " 449,\n",
       " 451,\n",
       " 452,\n",
       " 453,\n",
       " 455,\n",
       " 456,\n",
       " 457,\n",
       " 458,\n",
       " 459,\n",
       " 460,\n",
       " 461,\n",
       " 462,\n",
       " 463,\n",
       " 465,\n",
       " 467,\n",
       " 469,\n",
       " 470,\n",
       " 471,\n",
       " 472,\n",
       " 473,\n",
       " 474,\n",
       " 478,\n",
       " 481,\n",
       " 485,\n",
       " 486,\n",
       " 487,\n",
       " 489,\n",
       " 490,\n",
       " 491,\n",
       " 492,\n",
       " 495,\n",
       " 500,\n",
       " 502,\n",
       " 503,\n",
       " 504,\n",
       " 507,\n",
       " 509,\n",
       " 512,\n",
       " 513,\n",
       " 515,\n",
       " 516,\n",
       " 519,\n",
       " 521,\n",
       " 522,\n",
       " 524,\n",
       " 525,\n",
       " 526,\n",
       " 527,\n",
       " 531,\n",
       " 532,\n",
       " 533,\n",
       " 534,\n",
       " 535,\n",
       " 537,\n",
       " 538,\n",
       " 540,\n",
       " 544,\n",
       " 545,\n",
       " 547,\n",
       " 551,\n",
       " 552,\n",
       " 553,\n",
       " 555,\n",
       " 556,\n",
       " 557,\n",
       " 559,\n",
       " 560,\n",
       " 561,\n",
       " 563,\n",
       " 564,\n",
       " 566,\n",
       " 567,\n",
       " 569,\n",
       " 571,\n",
       " 572,\n",
       " 573,\n",
       " 576,\n",
       " 578,\n",
       " 583,\n",
       " 584,\n",
       " 585,\n",
       " 586,\n",
       " 587,\n",
       " 588,\n",
       " 590,\n",
       " 591,\n",
       " 592,\n",
       " 593,\n",
       " 594,\n",
       " 595,\n",
       " 596,\n",
       " 597,\n",
       " 602,\n",
       " 603,\n",
       " 604,\n",
       " 605,\n",
       " 606,\n",
       " 607,\n",
       " 608,\n",
       " 611,\n",
       " 614,\n",
       " 615,\n",
       " 616,\n",
       " 618,\n",
       " 619,\n",
       " 620,\n",
       " 621,\n",
       " 622,\n",
       " 623,\n",
       " 624,\n",
       " 625,\n",
       " 626,\n",
       " 627,\n",
       " 629,\n",
       " 630,\n",
       " 631,\n",
       " 632,\n",
       " 633,\n",
       " 635,\n",
       " 636,\n",
       " 641,\n",
       " 642,\n",
       " 643,\n",
       " 644,\n",
       " 645,\n",
       " 646,\n",
       " 647,\n",
       " 648,\n",
       " 651,\n",
       " 652,\n",
       " 654,\n",
       " 658,\n",
       " 661,\n",
       " 665,\n",
       " 666,\n",
       " 667,\n",
       " 668,\n",
       " 669,\n",
       " 670,\n",
       " 672,\n",
       " 675,\n",
       " 676,\n",
       " 677,\n",
       " 678,\n",
       " 679,\n",
       " 682,\n",
       " 683,\n",
       " 685,\n",
       " 686,\n",
       " 687,\n",
       " 690,\n",
       " 691,\n",
       " 694,\n",
       " 695,\n",
       " 696,\n",
       " 697,\n",
       " 698,\n",
       " 700,\n",
       " 701,\n",
       " 703,\n",
       " 705,\n",
       " 706,\n",
       " 707,\n",
       " 708]"
      ]
     },
     "execution_count": 514,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tree[1][3]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 517,
   "id": "281bb749",
   "metadata": {},
   "outputs": [],
   "source": [
    "def check_inc(y, yhat):\n",
    "    correct = 0\n",
    "    m = len(yhat)\n",
    "    for i in range(m):\n",
    "        if y[i] == 1:\n",
    "            correct += 1\n",
    "    \n",
    "    correct = correct / m\n",
    "        \n",
    "    return correct"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 520,
   "id": "2b515bf8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "36.285097192224626\n",
      "34.13654618473896\n"
     ]
    }
   ],
   "source": [
    "print(check_inc(y_train, tree[1][3])*100)\n",
    "print(check_inc(y_train, tree[2][3])*100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 519,
   "id": "d76355d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Survived</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Q</th>\n",
       "      <th>S</th>\n",
       "      <th>Parch_1</th>\n",
       "      <th>Parch_2</th>\n",
       "      <th>Parch_3</th>\n",
       "      <th>Parch_4</th>\n",
       "      <th>Parch_5</th>\n",
       "      <th>Parch_6</th>\n",
       "      <th>...</th>\n",
       "      <th>Age_Fare_1050.0</th>\n",
       "      <th>Age_Fare_1200.0</th>\n",
       "      <th>Age_Fare_1350.0</th>\n",
       "      <th>Age_Fare_1500.0</th>\n",
       "      <th>Age_Fare_1650.0</th>\n",
       "      <th>Age_Fare_1800.0</th>\n",
       "      <th>Age_Fare_1950.0</th>\n",
       "      <th>Age_Fare_2100.0</th>\n",
       "      <th>Age_Fare_2250.0</th>\n",
       "      <th>Age_Fare_2400.0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20 rows × 69 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Survived  Sex  Q  S  Parch_1  Parch_2  Parch_3  Parch_4  Parch_5  Parch_6  \\\n",
       "0          0    1  0  1        0        0        0        0        0        0   \n",
       "1          1    0  0  0        0        0        0        0        0        0   \n",
       "2          1    0  0  1        0        0        0        0        0        0   \n",
       "3          1    0  0  1        0        0        0        0        0        0   \n",
       "4          0    1  0  1        0        0        0        0        0        0   \n",
       "5          0    1  1  0        0        0        0        0        0        0   \n",
       "6          0    1  0  1        0        0        0        0        0        0   \n",
       "7          0    1  0  1        1        0        0        0        0        0   \n",
       "8          1    0  0  1        0        1        0        0        0        0   \n",
       "9          1    0  0  0        0        0        0        0        0        0   \n",
       "10         1    0  0  1        1        0        0        0        0        0   \n",
       "11         1    0  0  1        0        0        0        0        0        0   \n",
       "12         0    1  0  1        0        0        0        0        0        0   \n",
       "13         0    1  0  1        0        0        0        0        1        0   \n",
       "14         0    0  0  1        0        0        0        0        0        0   \n",
       "15         1    0  0  1        0        0        0        0        0        0   \n",
       "16         0    1  1  0        1        0        0        0        0        0   \n",
       "17         1    1  0  1        0        0        0        0        0        0   \n",
       "18         0    0  0  1        0        0        0        0        0        0   \n",
       "19         1    0  0  0        0        0        0        0        0        0   \n",
       "\n",
       "    ...  Age_Fare_1050.0  Age_Fare_1200.0  Age_Fare_1350.0  Age_Fare_1500.0  \\\n",
       "0   ...                0                0                0                0   \n",
       "1   ...                0                0                0                0   \n",
       "2   ...                0                0                0                0   \n",
       "3   ...                0                0                0                0   \n",
       "4   ...                0                0                0                0   \n",
       "5   ...                0                0                0                0   \n",
       "6   ...                0                0                0                0   \n",
       "7   ...                0                0                0                0   \n",
       "8   ...                0                0                0                0   \n",
       "9   ...                0                0                0                0   \n",
       "10  ...                0                0                0                0   \n",
       "11  ...                0                0                0                1   \n",
       "12  ...                0                0                0                0   \n",
       "13  ...                0                1                0                0   \n",
       "14  ...                0                0                0                0   \n",
       "15  ...                0                0                0                0   \n",
       "16  ...                0                0                0                0   \n",
       "17  ...                0                0                0                0   \n",
       "18  ...                0                0                0                0   \n",
       "19  ...                0                0                0                0   \n",
       "\n",
       "    Age_Fare_1650.0  Age_Fare_1800.0  Age_Fare_1950.0  Age_Fare_2100.0  \\\n",
       "0                 0                0                0                0   \n",
       "1                 0                0                0                0   \n",
       "2                 0                0                0                0   \n",
       "3                 0                1                0                0   \n",
       "4                 0                0                0                0   \n",
       "5                 0                0                0                0   \n",
       "6                 0                0                0                0   \n",
       "7                 0                0                0                0   \n",
       "8                 0                0                0                0   \n",
       "9                 0                0                0                0   \n",
       "10                0                0                0                0   \n",
       "11                0                0                0                0   \n",
       "12                0                0                0                0   \n",
       "13                0                0                0                0   \n",
       "14                0                0                0                0   \n",
       "15                0                0                0                0   \n",
       "16                0                0                0                0   \n",
       "17                0                0                0                0   \n",
       "18                0                0                0                0   \n",
       "19                0                0                0                0   \n",
       "\n",
       "    Age_Fare_2250.0  Age_Fare_2400.0  \n",
       "0                 0                0  \n",
       "1                 0                0  \n",
       "2                 0                0  \n",
       "3                 0                0  \n",
       "4                 0                0  \n",
       "5                 0                0  \n",
       "6                 0                0  \n",
       "7                 0                0  \n",
       "8                 0                0  \n",
       "9                 0                0  \n",
       "10                0                0  \n",
       "11                0                0  \n",
       "12                0                0  \n",
       "13                0                0  \n",
       "14                0                0  \n",
       "15                0                0  \n",
       "16                0                0  \n",
       "17                0                0  \n",
       "18                0                0  \n",
       "19                0                0  \n",
       "\n",
       "[20 rows x 69 columns]"
      ]
     },
     "execution_count": 519,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df[:20]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
